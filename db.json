{"meta":{"version":1,"warehouse":"1.0.3"},"models":{"Asset":[{"_id":"themes/hexo-theme-next/source/vendors/velocity/velocity.ui.min.js","path":"vendors/velocity/velocity.ui.min.js","modified":0},{"_id":"themes/hexo-theme-next/source/vendors/velocity/velocity.ui.js","path":"vendors/velocity/velocity.ui.js","modified":0},{"_id":"themes/hexo-theme-next/source/vendors/velocity/velocity.min.js","path":"vendors/velocity/velocity.min.js","modified":0},{"_id":"themes/hexo-theme-next/source/vendors/velocity/velocity.js","path":"vendors/velocity/velocity.js","modified":0},{"_id":"themes/hexo-theme-next/source/vendors/velocity/bower.json","path":"vendors/velocity/bower.json","modified":0},{"_id":"themes/hexo-theme-next/source/vendors/jquery/index.js","path":"vendors/jquery/index.js","modified":0},{"_id":"themes/hexo-theme-next/source/vendors/font-awesome/fonts/fontawesome-webfont.woff2","path":"vendors/font-awesome/fonts/fontawesome-webfont.woff2","modified":0},{"_id":"themes/hexo-theme-next/source/vendors/font-awesome/fonts/fontawesome-webfont.woff","path":"vendors/font-awesome/fonts/fontawesome-webfont.woff","modified":0},{"_id":"themes/hexo-theme-next/source/vendors/font-awesome/fonts/fontawesome-webfont.ttf","path":"vendors/font-awesome/fonts/fontawesome-webfont.ttf","modified":0},{"_id":"themes/hexo-theme-next/source/vendors/font-awesome/fonts/fontawesome-webfont.svg","path":"vendors/font-awesome/fonts/fontawesome-webfont.svg","modified":0},{"_id":"themes/hexo-theme-next/source/vendors/font-awesome/fonts/fontawesome-webfont.eot","path":"vendors/font-awesome/fonts/fontawesome-webfont.eot","modified":0},{"_id":"themes/hexo-theme-next/source/vendors/font-awesome/fonts/FontAwesome.otf","path":"vendors/font-awesome/fonts/FontAwesome.otf","modified":0},{"_id":"themes/hexo-theme-next/source/vendors/font-awesome/css/font-awesome.min.css","path":"vendors/font-awesome/css/font-awesome.min.css","modified":0},{"_id":"themes/hexo-theme-next/source/vendors/font-awesome/css/font-awesome.css.map","path":"vendors/font-awesome/css/font-awesome.css.map","modified":0},{"_id":"themes/hexo-theme-next/source/vendors/font-awesome/css/font-awesome.css","path":"vendors/font-awesome/css/font-awesome.css","modified":0},{"_id":"themes/hexo-theme-next/source/vendors/font-awesome/bower.json","path":"vendors/font-awesome/bower.json","modified":0},{"_id":"themes/hexo-theme-next/source/vendors/font-awesome/HELP-US-OUT.txt","path":"vendors/font-awesome/HELP-US-OUT.txt","modified":0},{"_id":"themes/hexo-theme-next/source/vendors/fastclick/lib/fastclick.min.js","path":"vendors/fastclick/lib/fastclick.min.js","modified":0},{"_id":"themes/hexo-theme-next/source/vendors/fastclick/lib/fastclick.js","path":"vendors/fastclick/lib/fastclick.js","modified":0},{"_id":"themes/hexo-theme-next/source/vendors/fastclick/bower.json","path":"vendors/fastclick/bower.json","modified":0},{"_id":"themes/hexo-theme-next/source/vendors/fastclick/README.md","path":"vendors/fastclick/README.md","modified":0},{"_id":"themes/hexo-theme-next/source/vendors/fastclick/LICENSE","path":"vendors/fastclick/LICENSE","modified":0},{"_id":"themes/hexo-theme-next/source/vendors/fancybox/source/jquery.fancybox.pack.js","path":"vendors/fancybox/source/jquery.fancybox.pack.js","modified":0},{"_id":"themes/hexo-theme-next/source/vendors/fancybox/source/jquery.fancybox.js","path":"vendors/fancybox/source/jquery.fancybox.js","modified":0},{"_id":"themes/hexo-theme-next/source/vendors/fancybox/source/jquery.fancybox.css","path":"vendors/fancybox/source/jquery.fancybox.css","modified":0},{"_id":"themes/hexo-theme-next/source/vendors/fancybox/source/helpers/jquery.fancybox-thumbs.js","path":"vendors/fancybox/source/helpers/jquery.fancybox-thumbs.js","modified":0},{"_id":"themes/hexo-theme-next/source/vendors/fancybox/source/helpers/jquery.fancybox-thumbs.css","path":"vendors/fancybox/source/helpers/jquery.fancybox-thumbs.css","modified":0},{"_id":"themes/hexo-theme-next/source/vendors/fancybox/source/helpers/jquery.fancybox-media.js","path":"vendors/fancybox/source/helpers/jquery.fancybox-media.js","modified":0},{"_id":"themes/hexo-theme-next/source/vendors/fancybox/source/helpers/jquery.fancybox-buttons.js","path":"vendors/fancybox/source/helpers/jquery.fancybox-buttons.js","modified":0},{"_id":"themes/hexo-theme-next/source/vendors/fancybox/source/helpers/jquery.fancybox-buttons.css","path":"vendors/fancybox/source/helpers/jquery.fancybox-buttons.css","modified":0},{"_id":"themes/hexo-theme-next/source/vendors/fancybox/source/helpers/fancybox_buttons.png","path":"vendors/fancybox/source/helpers/fancybox_buttons.png","modified":0},{"_id":"themes/hexo-theme-next/source/vendors/fancybox/source/fancybox_sprite@2x.png","path":"vendors/fancybox/source/fancybox_sprite@2x.png","modified":0},{"_id":"themes/hexo-theme-next/source/vendors/fancybox/source/fancybox_sprite.png","path":"vendors/fancybox/source/fancybox_sprite.png","modified":0},{"_id":"themes/hexo-theme-next/source/vendors/fancybox/source/fancybox_overlay.png","path":"vendors/fancybox/source/fancybox_overlay.png","modified":0},{"_id":"themes/hexo-theme-next/source/vendors/fancybox/source/fancybox_loading@2x.gif","path":"vendors/fancybox/source/fancybox_loading@2x.gif","modified":0},{"_id":"themes/hexo-theme-next/source/vendors/fancybox/source/fancybox_loading.gif","path":"vendors/fancybox/source/fancybox_loading.gif","modified":0},{"_id":"themes/hexo-theme-next/source/vendors/fancybox/source/blank.gif","path":"vendors/fancybox/source/blank.gif","modified":0},{"_id":"themes/hexo-theme-next/source/js/ua-parser.min.js","path":"js/ua-parser.min.js","modified":0},{"_id":"themes/hexo-theme-next/source/js/nav-toggle.js","path":"js/nav-toggle.js","modified":0},{"_id":"themes/hexo-theme-next/source/js/motion_global.js","path":"js/motion_global.js","modified":0},{"_id":"themes/hexo-theme-next/source/js/motion_fallback.js","path":"js/motion_fallback.js","modified":0},{"_id":"themes/hexo-theme-next/source/js/lazyload.js","path":"js/lazyload.js","modified":0},{"_id":"themes/hexo-theme-next/source/js/hook-duoshuo.js","path":"js/hook-duoshuo.js","modified":0},{"_id":"themes/hexo-theme-next/source/js/helpers.js","path":"js/helpers.js","modified":0},{"_id":"themes/hexo-theme-next/source/js/fancy-box.js","path":"js/fancy-box.js","modified":0},{"_id":"themes/hexo-theme-next/source/js/bootstrap.scrollspy.js","path":"js/bootstrap.scrollspy.js","modified":0},{"_id":"themes/hexo-theme-next/source/images/searchicon.png","path":"images/searchicon.png","modified":0},{"_id":"themes/hexo-theme-next/source/images/quote-r.svg","path":"images/quote-r.svg","modified":0},{"_id":"themes/hexo-theme-next/source/images/quote-l.svg","path":"images/quote-l.svg","modified":0},{"_id":"themes/hexo-theme-next/source/images/placeholder.gif","path":"images/placeholder.gif","modified":0},{"_id":"themes/hexo-theme-next/source/images/loading.gif","path":"images/loading.gif","modified":0},{"_id":"themes/hexo-theme-next/source/images/cc-zero.svg","path":"images/cc-zero.svg","modified":0},{"_id":"themes/hexo-theme-next/source/images/cc-by.svg","path":"images/cc-by.svg","modified":0},{"_id":"themes/hexo-theme-next/source/images/cc-by-sa.svg","path":"images/cc-by-sa.svg","modified":0},{"_id":"themes/hexo-theme-next/source/images/cc-by-nd.svg","path":"images/cc-by-nd.svg","modified":0},{"_id":"themes/hexo-theme-next/source/images/cc-by-nc.svg","path":"images/cc-by-nc.svg","modified":0},{"_id":"themes/hexo-theme-next/source/images/cc-by-nc-sa.svg","path":"images/cc-by-nc-sa.svg","modified":0},{"_id":"themes/hexo-theme-next/source/images/cc-by-nc-nd.svg","path":"images/cc-by-nc-nd.svg","modified":0},{"_id":"themes/hexo-theme-next/source/images/bkdefault_avatar.jpg","path":"images/bkdefault_avatar.jpg","modified":0},{"_id":"themes/hexo-theme-next/source/fonts/icon-linecons/selection.json","path":"fonts/icon-linecons/selection.json","modified":0},{"_id":"themes/hexo-theme-next/source/fonts/icon-linecons/icomoon.woff","path":"fonts/icon-linecons/icomoon.woff","modified":0},{"_id":"themes/hexo-theme-next/source/fonts/icon-linecons/icomoon.ttf","path":"fonts/icon-linecons/icomoon.ttf","modified":0},{"_id":"themes/hexo-theme-next/source/fonts/icon-linecons/icomoon.svg","path":"fonts/icon-linecons/icomoon.svg","modified":0},{"_id":"themes/hexo-theme-next/source/fonts/icon-linecons/icomoon.eot","path":"fonts/icon-linecons/icomoon.eot","modified":0},{"_id":"themes/hexo-theme-next/source/fonts/icon-icomoon/icomoon.woff","path":"fonts/icon-icomoon/icomoon.woff","modified":0},{"_id":"themes/hexo-theme-next/source/fonts/icon-icomoon/icomoon.ttf","path":"fonts/icon-icomoon/icomoon.ttf","modified":0},{"_id":"themes/hexo-theme-next/source/fonts/icon-icomoon/icomoon.svg","path":"fonts/icon-icomoon/icomoon.svg","modified":0},{"_id":"themes/hexo-theme-next/source/fonts/icon-icomoon/icomoon.eot","path":"fonts/icon-icomoon/icomoon.eot","modified":0},{"_id":"themes/hexo-theme-next/source/fonts/icon-fifty-shades/selection.json","path":"fonts/icon-fifty-shades/selection.json","modified":0},{"_id":"themes/hexo-theme-next/source/fonts/icon-fifty-shades/icomoon.woff","path":"fonts/icon-fifty-shades/icomoon.woff","modified":0},{"_id":"themes/hexo-theme-next/source/fonts/icon-fifty-shades/icomoon.ttf","path":"fonts/icon-fifty-shades/icomoon.ttf","modified":0},{"_id":"themes/hexo-theme-next/source/fonts/icon-fifty-shades/icomoon.svg","path":"fonts/icon-fifty-shades/icomoon.svg","modified":0},{"_id":"themes/hexo-theme-next/source/fonts/icon-fifty-shades/icomoon.eot","path":"fonts/icon-fifty-shades/icomoon.eot","modified":0},{"_id":"themes/hexo-theme-next/source/fonts/icon-feather/selection.json","path":"fonts/icon-feather/selection.json","modified":0},{"_id":"themes/hexo-theme-next/source/fonts/icon-feather/icomoon.woff","path":"fonts/icon-feather/icomoon.woff","modified":0},{"_id":"themes/hexo-theme-next/source/fonts/icon-feather/icomoon.ttf","path":"fonts/icon-feather/icomoon.ttf","modified":0},{"_id":"themes/hexo-theme-next/source/fonts/icon-feather/icomoon.svg","path":"fonts/icon-feather/icomoon.svg","modified":0},{"_id":"themes/hexo-theme-next/source/fonts/icon-feather/icomoon.eot","path":"fonts/icon-feather/icomoon.eot","modified":0},{"_id":"themes/hexo-theme-next/source/fonts/icon-default/selection.json","path":"fonts/icon-default/selection.json","modified":0},{"_id":"themes/hexo-theme-next/source/fonts/icon-default/icomoon.woff","path":"fonts/icon-default/icomoon.woff","modified":0},{"_id":"themes/hexo-theme-next/source/fonts/icon-default/icomoon.ttf","path":"fonts/icon-default/icomoon.ttf","modified":0},{"_id":"themes/hexo-theme-next/source/fonts/icon-default/icomoon.svg","path":"fonts/icon-default/icomoon.svg","modified":0},{"_id":"themes/hexo-theme-next/source/fonts/icon-default/icomoon.eot","path":"fonts/icon-default/icomoon.eot","modified":0},{"_id":"themes/hexo-theme-next/source/css/main.styl","path":"css/main.styl","modified":0},{"_id":"source/CNAME","path":"CNAME","modified":0}],"Cache":[{"_id":"source/404.html","shasum":"75f79c7a9f1072300986dc8b56e6cca36b2b7646","modified":1445668935000},{"_id":"source/CNAME","shasum":"58a245e5291e156ffab1f3b84219930adbdf45d2","modified":1445668371000},{"_id":"source/_posts/Cowboy的路由机制.md","shasum":"ffffc1ed15222492acd846f06c59be7a63f9c85c","modified":1445509518000},{"_id":"source/_posts/Erlang-Efficiency-guide-非标准笔记.md","shasum":"d1c13a6565bfc2e5a4e15aa9893606c4863ff823","modified":1445668103000},{"_id":"source/_posts/Erlang发送邮件相关问题.md","shasum":"ae42f367acd33576e535d7bccc282ec7197c740f","modified":1445509415000},{"_id":"source/_posts/Erlang通过NIF集成c代码示例.md","shasum":"6d526b75fdd71aae51c57c78ea295383f35ddba1","modified":1445520287000},{"_id":"source/_posts/MQTT-V1-3-协议详解.md","shasum":"e2d245069ac83d05d67543fffa78b6135d8e7927","modified":1445668525000},{"_id":"source/_posts/Riak安装与MapReduce测试.md","shasum":"5347e88b997c7db04e4ae0b23713d67a12003e2f","modified":1445517242000},{"_id":"source/_posts/ejabberd-receiver分析.md","shasum":"6366dad5974e562f9a5c01e80c4f3dfbfd08c04d","modified":1445515880000},{"_id":"source/tags/index.md","shasum":"e2bf6350397182767e9bc51838233ce78acd208b","modified":1445509636000},{"_id":"themes/hexo-theme-next/source/css/_common/_page/home.styl","shasum":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/css/_mixins/Mist.styl","shasum":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/css/_mixins/custom.styl","shasum":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/css/_mixins/default.styl","shasum":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/css/_variables/custom.styl","shasum":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/css/_variables/default.styl","shasum":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1445505232000},{"_id":"themes/hexo-theme-next/README.en.md","shasum":"565ba52b3825b85a9f05b41183caca7f18b741d4","modified":1445505232000},{"_id":"themes/hexo-theme-next/README.md","shasum":"3319de8565699fc9642f76c41ee96b50f2234b6a","modified":1445505232000},{"_id":"themes/hexo-theme-next/_config.yml","shasum":"16e2d76357af96c5b73975fcca2f664ea3fe0cbe","modified":1445820161000},{"_id":"themes/hexo-theme-next/bower.json","shasum":"c27f03e42e91a205f1b2acbcf562f8b66e5a23c6","modified":1445505232000},{"_id":"themes/hexo-theme-next/languages/de.yml","shasum":"7a8de0e5665c52a1bf168c1e7dd222c8a74fb0ab","modified":1445505232000},{"_id":"themes/hexo-theme-next/languages/default.yml","shasum":"7e65ef918f16d0189055deb5f1616b9dedcb1920","modified":1445505232000},{"_id":"themes/hexo-theme-next/languages/en.yml","shasum":"7e65ef918f16d0189055deb5f1616b9dedcb1920","modified":1445505232000},{"_id":"themes/hexo-theme-next/languages/fr-FR.yml","shasum":"6d097445342a9fb5235afea35d65bf5271b772f0","modified":1445505232000},{"_id":"themes/hexo-theme-next/languages/pt.yml","shasum":"737225eee4b91f64db61742ce3f4ab4e8c039286","modified":1445505232000},{"_id":"themes/hexo-theme-next/languages/ru.yml","shasum":"b4a827b9ddac9d5f6dca096fe513aeafb46a3e93","modified":1445505232000},{"_id":"themes/hexo-theme-next/languages/zh-Hans.yml","shasum":"8af76df5557561050a950bdd7091d3bb3939c5c0","modified":1445505232000},{"_id":"themes/hexo-theme-next/languages/zh-hk.yml","shasum":"3fc38103c9efa6f6c37149adbddb014ff85ec849","modified":1445505232000},{"_id":"themes/hexo-theme-next/languages/zh-tw.yml","shasum":"8897a06e521b36c7a1226c72057c8357611eded8","modified":1445505232000},{"_id":"themes/hexo-theme-next/layout/_layout.swig","shasum":"8facc6d027289182c31556085a2a9b675d649e0f","modified":1445516947000},{"_id":"themes/hexo-theme-next/layout/_macro/post-collapse.swig","shasum":"9032ae9056cb19b4c2d069d66ead7abf828f9922","modified":1445505232000},{"_id":"themes/hexo-theme-next/layout/_macro/post.swig","shasum":"b3cd721e5100991a0fa85d966afbf22f7b0d62ef","modified":1445505232000},{"_id":"themes/hexo-theme-next/layout/_macro/sidebar.swig","shasum":"81a3e9b17b633d795d1f0217db6eb38eda57087d","modified":1445505232000},{"_id":"themes/hexo-theme-next/layout/_partials/footer.swig","shasum":"970a669aae1889d37b2028d174d9d45e88dc0e4f","modified":1445505232000},{"_id":"themes/hexo-theme-next/layout/_partials/head.swig","shasum":"c6f0d2c77f41a10e661177972195905116b175c1","modified":1445505232000},{"_id":"themes/hexo-theme-next/layout/_partials/header.swig","shasum":"8e62c261dc6cafeedfa8c79971d316b8f7bf39fe","modified":1445819872000},{"_id":"themes/hexo-theme-next/layout/_partials/old-browsers.swig","shasum":"dbbfea810bf3a2ed9c83b9a6683037175aacfc67","modified":1445505232000},{"_id":"themes/hexo-theme-next/layout/_partials/pagination.swig","shasum":"9e8e21d194ef44d271b1cca0bc1448c14d7edf4f","modified":1445505232000},{"_id":"themes/hexo-theme-next/layout/_partials/search/swiftype.swig","shasum":"00c2b49f6289198b0b2b4e157e4ee783277f32a7","modified":1445505232000},{"_id":"themes/hexo-theme-next/layout/_partials/search/tinysou.swig","shasum":"eefe2388ff3d424694045eda21346989b123977c","modified":1445505232000},{"_id":"themes/hexo-theme-next/layout/_partials/search.swig","shasum":"64f14da26792a17bc27836c4e9d83190175f36e6","modified":1445505232000},{"_id":"themes/hexo-theme-next/layout/_partials/share/duoshuo_share.swig","shasum":"89c5a5240ecb223acfe1d12377df5562a943fd5d","modified":1445505232000},{"_id":"themes/hexo-theme-next/layout/_partials/share/jiathis.swig","shasum":"63315fcf210799f894208c9f512737096df84962","modified":1445505232000},{"_id":"themes/hexo-theme-next/layout/_scripts/analytics/baidu-analytics.swig","shasum":"7c43d66da93cde65b473a7d6db2a86f9a42647d6","modified":1445505232000},{"_id":"themes/hexo-theme-next/layout/_scripts/analytics/facebook-sdk.swig","shasum":"334176d838ee528e58468d8bc74ff3a6d3f25b2b","modified":1445505232000},{"_id":"themes/hexo-theme-next/layout/_scripts/analytics/google-analytics.swig","shasum":"30a23fa7e816496fdec0e932aa42e2d13098a9c2","modified":1445505232000},{"_id":"themes/hexo-theme-next/layout/_scripts/analytics.swig","shasum":"33ca06b9bd9a15a19432d5396b85bd319f017319","modified":1445505232000},{"_id":"themes/hexo-theme-next/layout/_scripts/baidushare.swig","shasum":"d726361945437cf6e48067b3dd041b7e36e98d85","modified":1445505232000},{"_id":"themes/hexo-theme-next/layout/_scripts/bootstrap.scrollspy.swig","shasum":"85295f126836b95f0837d03e58228bb3cf8c4490","modified":1445505232000},{"_id":"themes/hexo-theme-next/layout/_scripts/comments/disqus.swig","shasum":"3491d3cebabc8a28857200db28a1be65aad6adc2","modified":1445505232000},{"_id":"themes/hexo-theme-next/layout/_scripts/comments/duoshuo.swig","shasum":"06b6cfaa9f2e05a9b0e8eb7c6d37cca92bcb9c77","modified":1445505232000},{"_id":"themes/hexo-theme-next/layout/_scripts/fancy-box.swig","shasum":"41b4ff1446060c88c33bf666a32277dcf12129f0","modified":1445505232000},{"_id":"themes/hexo-theme-next/layout/_scripts/helpers.swig","shasum":"4d2cbfca0aaf546a2b5813288073e824c1498fdf","modified":1445505232000},{"_id":"themes/hexo-theme-next/layout/_scripts/mathjax.swig","shasum":"df03220eb8526e17dc9c9f17780c2d6699367181","modified":1445505232000},{"_id":"themes/hexo-theme-next/layout/_scripts/motion.swig","shasum":"817705bfd1a1282cb6bf59094afe507e11455aa0","modified":1445505232000},{"_id":"themes/hexo-theme-next/layout/_scripts/pages/post-details.swig","shasum":"a6cbba49a78648a2345d1fc94c1abd14b2c3c6ba","modified":1445505232000},{"_id":"themes/hexo-theme-next/layout/_scripts/tinysou.swig","shasum":"cb3a5d36dbe1630bab84e03a52733a46df7c219b","modified":1445505232000},{"_id":"themes/hexo-theme-next/layout/archive.swig","shasum":"1148db1979bbb513e064148b42d160192a3e24ac","modified":1445516357000},{"_id":"themes/hexo-theme-next/layout/category.swig","shasum":"d6b3e1dc5e0b8deade9a084c463126e70188ee9b","modified":1445507544000},{"_id":"themes/hexo-theme-next/layout/index.swig","shasum":"fdc801f0da71a2eb205ce9c0b12f156b219fdc9c","modified":1445505232000},{"_id":"themes/hexo-theme-next/layout/page.swig","shasum":"0b29674f4f20d9118ba1e713d684f9ba9f5c0c2f","modified":1445516650000},{"_id":"themes/hexo-theme-next/layout/post.swig","shasum":"a84457e8ced46e63bc7a8a9e0541a6ba53122a92","modified":1445505232000},{"_id":"themes/hexo-theme-next/layout/tag.swig","shasum":"aab44af54fcbc66fea4ad12b2767ffca3eadd451","modified":1445505232000},{"_id":"themes/hexo-theme-next/scripts/merge-configs.js","shasum":"dfd147d1317e56d283f5e779f00608e913603b51","modified":1445505232000},{"_id":"themes/hexo-theme-next/scripts/tags/center-quote.js","shasum":"535fc542781021c4326dec24d8495cbb1387634a","modified":1445505232000},{"_id":"themes/hexo-theme-next/scripts/tags/full-image.js","shasum":"6329dc1815721050fd4c24a8accd8f4cbdb52330","modified":1445505232000},{"_id":"themes/hexo-theme-next/scripts/tags/group-pictures.js","shasum":"49252824cd53184dc9b97b2f2d87ff28e1b3ef27","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/css/_common/_component/back-to-top.styl","shasum":"88cd66910260006aa8e9e795df4948d4b67bfa11","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/css/_common/_component/blockquote-center.styl","shasum":"c2abe4d87148e23e15d49ee225bc650de60baf46","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/css/_common/_component/buttons.styl","shasum":"81063e0979f04a0f9af37f321d7321dda9abf593","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/css/_common/_component/comments.styl","shasum":"471f1627891aca5c0e1973e09fbcb01e1510d193","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/css/_common/_component/duoshuo.styl","shasum":"6ad988254fe34a03e8ddfa8d4941e196bd07d238","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/css/_common/_component/gallery.styl","shasum":"387ce23bba52b22a586b2dfb4ec618fe1ffd3926","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/css/_common/_component/group-pictures.styl","shasum":"1ee40743000173495728855f734081eb2b6167cc","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/css/_common/_component/jiathis.styl","shasum":"327b5f63d55ec26f7663185c1a778440588d9803","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/css/_common/_component/pagination.styl","shasum":"711c8830886619d4f4a0598b0cde5499dce50c62","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/css/_common/_component/posts-collapse.styl","shasum":"6750b61236eb359028da8f2c4765f7c89b03dc9a","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/css/_common/_component/posts-expand.styl","shasum":"494bed4c864b3a98f443cba6793523384f6f8d12","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/css/_common/_component/posts-type.styl","shasum":"40b593134bf96d1d6095b3439d47820659d7f10b","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/css/_common/_component/posts.styl","shasum":"c3cbb56b3fc836af28db094da30ba74ff58245cd","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/css/_common/_component/tag-cloud.styl","shasum":"dd8a3b22fc2f222ac6e6c05bd8a773fb039169c0","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/css/_common/_core/base.styl","shasum":"920c4de5e19faa8fcaff3c5f585af41f4f553cbf","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/css/_common/_core/helpers.styl","shasum":"d339d114e52a9abbc797ec236a8a770c29e288a6","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/css/_common/_core/normalize.styl","shasum":"ece571f38180febaf02ace8187ead8318a300ea7","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/css/_common/_core/scaffolding.styl","shasum":"1f8acb3331300eec696a09e7859e11f191e16d7f","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/css/_common/_core/tables.styl","shasum":"5f766cf26f966dbf9dcfe681f40ab9032e3e8a08","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/css/_common/_fonts/icon-default.styl","shasum":"8b809aef383bebaeb3f282b47675f3a364ce3569","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/css/_common/_fonts/icon-feather.styl","shasum":"80413afacfa656322100ce1900fed1ebcd8f8f44","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/css/_common/_fonts/icon-fifty-shades.styl","shasum":"249f75bafa26b99d272352c0646e7497ea680b39","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/css/_common/_fonts/icon-font.styl","shasum":"ec3f86739bede393cafcd3e31052c01115ae20d6","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/css/_common/_fonts/icon-linecons.styl","shasum":"9cdbedb3627ac941cfb063b152abe5a75c3c699a","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/css/_common/_page/archive.styl","shasum":"dff879f55ca65fa79c07e9098719e53eeea7ac88","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/css/_common/_page/categories.styl","shasum":"4f696a2eaeee2f214adcf273eab25c62a398077a","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/css/_common/_page/post-detail.styl","shasum":"9bf4362a4d0ae151ada84b219d39fbe5bb8c790e","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/css/_common/_section/body.styl","shasum":"ca1a4766cbe25baac757c6b47a4858d221afdc40","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/css/_common/_section/footer.styl","shasum":"8994ffcce84deac0471532f270f97c44fea54dc0","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/css/_common/_section/header.styl","shasum":"e351f1ebc0d3c63e3443bcba3a34677b06c37455","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/css/_common/_section/layout.styl","shasum":"03ae7b808dde9065412968aa69916162e790455d","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/css/_common/_section/media.styl","shasum":"fa9809d2ecc753cf32f70803c1d0821c405211f4","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/css/_common/_section/sidebar.styl","shasum":"edaae01f7232c3fef9bf32ff1bdcf8a04d1aa6cd","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/css/_common/_vendor/highlight/highlight.styl","shasum":"6242be4307a3b3dafc14e556f51c8875c41a1ddd","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/css/_common/_vendor/highlight/theme.styl","shasum":"ae19721ceee5ba460e131cb2427dae3c1ff39d6f","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/css/_custom/custom.styl","shasum":"328d9a9696cc2ccf59c67d3c26000d569f46344c","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/css/_mixins/base.styl","shasum":"4e49707c99c8bbcfa0a607dfdaff0fbb7dffd2a3","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/css/_schemes/Mist/_base.styl","shasum":"d50c2a9ae363d26ed2e9bc226a9dc7abeb9ace1b","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/css/_schemes/Mist/_header.styl","shasum":"1631a430655eadb485574d1a9bedd49460988b11","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/css/_schemes/Mist/_logo.styl","shasum":"38e5df90c8689a71c978fd83ba74af3d4e4e5386","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/css/_schemes/Mist/_menu.styl","shasum":"5a8036fc61207ca0fe38c9782ed2f686fbf764be","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/css/_schemes/Mist/_posts-expanded.styl","shasum":"b7366f28bd7902bfc1dce24f2bd5ae5439fb6e2f","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/css/_schemes/Mist/index.styl","shasum":"fc7d96b897290dbd93bc8c515a2058fc4c374ea7","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/css/_schemes/default/_logo.styl","shasum":"8829bc556ca38bfec4add4f15a2f028092ac6d46","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/css/_schemes/default/_menu.styl","shasum":"4bba29cece65ffc5122f4e052063dea4439fe4ae","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/css/_schemes/default/_search.styl","shasum":"c524bccdc554349106d1c8be9c3f275d4c0d4281","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/css/_schemes/default/index.styl","shasum":"159464cb8a7e01e32db9ec70dec391ec70a72f9c","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/css/_variables/Mist.styl","shasum":"9f8791860cc1ca724d2dfe609e8cd6abc44d6926","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/css/_variables/base.styl","shasum":"403ec86631ab907f976284bc1a6c53a9b3e23a21","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/css/main.styl","shasum":"56dacee56c5eaa4b2676d196452314fb50f758aa","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/fonts/icon-default/icomoon.eot","shasum":"90763e97be18be78e65749075225cceeddc6fa8a","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/fonts/icon-default/icomoon.svg","shasum":"f92ad8cddc250f0bb5ca466fca95d321987e127e","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/fonts/icon-default/icomoon.ttf","shasum":"c093408e6030221cafc1f79d897f1fb5283c1178","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/fonts/icon-default/icomoon.woff","shasum":"dbe0368f2a65d87b13234cfea29d9783892fc7a8","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/fonts/icon-default/selection.json","shasum":"dc07c29f687315f9458f6b251c214768af865fb2","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/fonts/icon-feather/icomoon.eot","shasum":"11554b9e9d5b9f535ba96cbb27d45d8c8f1689fd","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/fonts/icon-feather/icomoon.svg","shasum":"d5eb756eefda9b454dcb23c2b1cefd4051d18d41","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/fonts/icon-feather/icomoon.ttf","shasum":"b2bbae4b613403cf61ad25037913378da1c07b8f","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/fonts/icon-feather/icomoon.woff","shasum":"2ea1c59c17422798e64ee6f4e9ce1f7aff1a06a5","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/fonts/icon-feather/selection.json","shasum":"06ea91e3f98ebe1080087acad4356802bc5b6ebf","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/fonts/icon-fifty-shades/icomoon.eot","shasum":"da86ba5df72d1288de9e9633e5f528062dd427d5","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/fonts/icon-fifty-shades/icomoon.svg","shasum":"1a4afd739e1f8eb8d430dbdd29e36a9999802e8d","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/fonts/icon-fifty-shades/icomoon.ttf","shasum":"72fe82e1f3db52414eed706952d385af241cb196","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/fonts/icon-fifty-shades/icomoon.woff","shasum":"4de6a74f523dee33d95dde61caae5809f9a5d448","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/fonts/icon-fifty-shades/selection.json","shasum":"fdd09098d1c3688e2c88cf33fd51e76b383b6d7f","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/fonts/icon-icomoon/icomoon.eot","shasum":"301fcf00c24750dddf1c529f944ca62c7f1a217d","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/fonts/icon-icomoon/icomoon.svg","shasum":"e316347805eb93425faa678611c5e42a7152da8f","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/fonts/icon-icomoon/icomoon.ttf","shasum":"f399713d1c9400d4d3373e38991a7e362a754a94","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/fonts/icon-icomoon/icomoon.woff","shasum":"05f1ec0bd307da5e731a86eb4961589a6042aebb","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/fonts/icon-linecons/icomoon.eot","shasum":"e2d7f040428a632f3c50bfa94083b759936effc2","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/fonts/icon-linecons/icomoon.svg","shasum":"808eaf7d61f7e67c76976265c885e79c36920f0b","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/fonts/icon-linecons/icomoon.ttf","shasum":"078068206684e4f185b0187ad3cee16f54a287d7","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/fonts/icon-linecons/icomoon.woff","shasum":"0b07ee6ceda3b1bceb40c1e7379b3aa48dcc15a8","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/fonts/icon-linecons/selection.json","shasum":"db4ce25d31449ecc6685b32e145252103967bb5c","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/images/bkdefault_avatar.jpg","shasum":"b687bb4bfbe35a32b592c24d652ba80cfdc770fc","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/images/cc-by-nc-nd.svg","shasum":"c6524ece3f8039a5f612feaf865d21ec8a794564","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/images/cc-by-nc-sa.svg","shasum":"3031be41e8753c70508aa88e84ed8f4f653f157e","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/images/cc-by-nc.svg","shasum":"8d39b39d88f8501c0d27f8df9aae47136ebc59b7","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/images/cc-by-nd.svg","shasum":"c563508ce9ced1e66948024ba1153400ac0e0621","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/images/cc-by-sa.svg","shasum":"aa4742d733c8af8d38d4c183b8adbdcab045872e","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/images/cc-by.svg","shasum":"28a0a4fe355a974a5e42f68031652b76798d4f7e","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/images/cc-zero.svg","shasum":"87669bf8ac268a91d027a0a4802c92a1473e9030","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/images/loading.gif","shasum":"5fbd472222feb8a22cf5b8aa5dc5b8e13af88e2b","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/images/placeholder.gif","shasum":"5fbd472222feb8a22cf5b8aa5dc5b8e13af88e2b","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/images/quote-l.svg","shasum":"94e870b4c8c48da61d09522196d4dd40e277a98f","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/images/quote-r.svg","shasum":"e60ae504f9d99b712c793c3740c6b100d057d4ec","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/images/searchicon.png","shasum":"67727a6a969be0b2659b908518fa6706eed307b8","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/js/bootstrap.scrollspy.js","shasum":"ae7bdce88b515aade4eea8bf7407eec458bcd625","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/js/fancy-box.js","shasum":"62d38913d8e8a5736ecc48a0b343f67e86a0ae32","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/js/helpers.js","shasum":"c15216ef897334362789ba37464298948b2eef95","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/js/hook-duoshuo.js","shasum":"de3c14f49ac5f20b2065377dd1872749d067ebf9","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/js/lazyload.js","shasum":"b92e9acdc7afc15468314c03f4a643b0c93944cf","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/js/motion_fallback.js","shasum":"a767d522c65a8b2fbad49135c9332135c6785c3e","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/js/motion_global.js","shasum":"2322d677b3dbed5506f3b79ec3d1ebe7e019f115","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/js/nav-toggle.js","shasum":"78b59f1beb12adea0d7f9bcf4377cb699963f220","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/js/ua-parser.min.js","shasum":"38628e75e4412cc6f11074e03e1c6d257aae495b","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/vendors/fancybox/source/blank.gif","shasum":"2daeaa8b5f19f0bc209d976c02bd6acb51b00b0a","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/vendors/fancybox/source/fancybox_loading.gif","shasum":"1a755fb2599f3a313cc6cfdb14df043f8c14a99c","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/vendors/fancybox/source/fancybox_loading@2x.gif","shasum":"273b123496a42ba45c3416adb027cd99745058b0","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/vendors/fancybox/source/fancybox_overlay.png","shasum":"b3a4ee645ba494f52840ef8412015ba0f465dbe0","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/vendors/fancybox/source/fancybox_sprite.png","shasum":"17df19f97628e77be09c352bf27425faea248251","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/vendors/fancybox/source/fancybox_sprite@2x.png","shasum":"30c58913f327e28f466a00f4c1ac8001b560aed8","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/vendors/fancybox/source/helpers/fancybox_buttons.png","shasum":"e385b139516c6813dcd64b8fc431c364ceafe5f3","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/vendors/fancybox/source/helpers/jquery.fancybox-buttons.css","shasum":"1a9d8e5c22b371fcc69d4dbbb823d9c39f04c0c8","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/vendors/fancybox/source/helpers/jquery.fancybox-buttons.js","shasum":"91e41741c2e93f732c82aaacec4cfc6e3f3ec876","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/vendors/fancybox/source/helpers/jquery.fancybox-media.js","shasum":"3bdf69ed2469e4fb57f5a95f17300eef891ff90d","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/vendors/fancybox/source/helpers/jquery.fancybox-thumbs.css","shasum":"4ac329c16a5277592fc12a37cca3d72ca4ec292f","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/vendors/fancybox/source/helpers/jquery.fancybox-thumbs.js","shasum":"53e194f4a72e649c04fb586dd57762b8c022800b","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/vendors/fancybox/source/jquery.fancybox.css","shasum":"5f163444617b6cf267342f06ac166a237bb62df9","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/vendors/fancybox/source/jquery.fancybox.js","shasum":"1cf3d47b5ccb7cb6e9019c64f2a88d03a64853e4","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/vendors/fancybox/source/jquery.fancybox.pack.js","shasum":"53360764b429c212f424399384417ccc233bb3be","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/vendors/fastclick/LICENSE","shasum":"dcd5b6b43095d9e90353a28b09cb269de8d4838e","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/vendors/fastclick/README.md","shasum":"1decd8e1adad2cd6db0ab50cf56de6035156f4ea","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/vendors/fastclick/bower.json","shasum":"13379463c7463b4b96d13556b46faa4cc38d81e6","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/vendors/fastclick/lib/fastclick.js","shasum":"06cef196733a710e77ad7e386ced6963f092dc55","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/vendors/fastclick/lib/fastclick.min.js","shasum":"2cae0f5a6c5d6f3cb993015e6863f9483fc4de18","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/vendors/font-awesome/HELP-US-OUT.txt","shasum":"69a4c537d167b68a0ccf1c6febd138aeffca60d6","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/vendors/font-awesome/bower.json","shasum":"279a8a718ab6c930a67c41237f0aac166c1b9440","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/vendors/font-awesome/css/font-awesome.css","shasum":"3b87c2560832748cd06f9bfd2fd6ea8edbdae8c7","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/vendors/font-awesome/css/font-awesome.css.map","shasum":"0189d278706509412bac4745f96c83984e1d59f4","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/vendors/font-awesome/css/font-awesome.min.css","shasum":"05ea25bc9b3ac48993e1fee322d3bc94b49a6e22","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/vendors/font-awesome/fonts/fontawesome-webfont.woff2","shasum":"574ea2698c03ae9477db2ea3baf460ee32f1a7ea","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/vendors/velocity/bower.json","shasum":"2ec99573e84c7117368beccb9e94b6bf35d2db03","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/vendors/velocity/velocity.min.js","shasum":"2f1afadc12e4cf59ef3b405308d21baa97e739c6","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/vendors/velocity/velocity.ui.js","shasum":"6a1d101eab3de87527bb54fcc8c7b36b79d8f0df","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/vendors/velocity/velocity.ui.min.js","shasum":"ed5e534cd680a25d8d14429af824f38a2c7d9908","modified":1445505232000},{"_id":"themes/hexo-theme-next/test/helpers.js","shasum":"a1f5de25154c3724ffc24a91ddc576cdbd60864f","modified":1445505232000},{"_id":"themes/hexo-theme-next/test/intern.js","shasum":"11fa8a4f5c3b4119a179ae0a2584c8187f907a73","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/vendors/font-awesome/fonts/FontAwesome.otf","shasum":"0112e96f327d413938d37c1693806f468ffdbace","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/vendors/font-awesome/fonts/fontawesome-webfont.eot","shasum":"b3c2f08e73320135b69c23a3908b87a12053a2f6","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/vendors/font-awesome/fonts/fontawesome-webfont.woff","shasum":"507970402e328b2baeb05bde73bf9ded4e2c3a2d","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/vendors/jquery/index.js","shasum":"41b4bfbaa96be6d1440db6e78004ade1c134e276","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/vendors/font-awesome/fonts/fontawesome-webfont.ttf","shasum":"27cf1f2ec59aece6938c7bb2feb0e287ea778ff9","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/vendors/velocity/velocity.js","shasum":"e63dc7cea055ca60a95d286f32349d88b10c5a4d","modified":1445505232000},{"_id":"themes/hexo-theme-next/source/vendors/font-awesome/fonts/fontawesome-webfont.svg","shasum":"2b3c8ba7008cc014d8fb37abc6f9f49aeda83824","modified":1445505232000},{"_id":"public/vendors/velocity/velocity.ui.min.js","modified":1445820063551,"shasum":"ed5e534cd680a25d8d14429af824f38a2c7d9908"},{"_id":"public/vendors/velocity/velocity.ui.js","modified":1445820063555,"shasum":"6a1d101eab3de87527bb54fcc8c7b36b79d8f0df"},{"_id":"public/vendors/velocity/velocity.min.js","modified":1445820063558,"shasum":"2f1afadc12e4cf59ef3b405308d21baa97e739c6"},{"_id":"public/vendors/velocity/velocity.js","modified":1445820063562,"shasum":"9f08181baea0cc0e906703b7e5df9111b9ef3373"},{"_id":"public/vendors/velocity/bower.json","modified":1445820063567,"shasum":"0ef14e7ccdfba5db6eb3f8fc6aa3b47282c36409"},{"_id":"public/vendors/jquery/index.js","modified":1445820063569,"shasum":"41b4bfbaa96be6d1440db6e78004ade1c134e276"},{"_id":"public/vendors/font-awesome/fonts/fontawesome-webfont.woff2","modified":1445820063575,"shasum":"574ea2698c03ae9477db2ea3baf460ee32f1a7ea"},{"_id":"public/vendors/font-awesome/fonts/fontawesome-webfont.woff","modified":1445820063581,"shasum":"507970402e328b2baeb05bde73bf9ded4e2c3a2d"},{"_id":"public/vendors/font-awesome/fonts/fontawesome-webfont.ttf","modified":1445820063587,"shasum":"27cf1f2ec59aece6938c7bb2feb0e287ea778ff9"},{"_id":"public/vendors/font-awesome/fonts/fontawesome-webfont.svg","modified":1445820063596,"shasum":"2b3c8ba7008cc014d8fb37abc6f9f49aeda83824"},{"_id":"public/vendors/font-awesome/fonts/fontawesome-webfont.eot","modified":1445820063603,"shasum":"b3c2f08e73320135b69c23a3908b87a12053a2f6"},{"_id":"public/vendors/font-awesome/fonts/FontAwesome.otf","modified":1445820063609,"shasum":"0112e96f327d413938d37c1693806f468ffdbace"},{"_id":"public/vendors/font-awesome/css/font-awesome.min.css","modified":1445820063615,"shasum":"05ea25bc9b3ac48993e1fee322d3bc94b49a6e22"},{"_id":"public/vendors/font-awesome/css/font-awesome.css.map","modified":1445820063620,"shasum":"0189d278706509412bac4745f96c83984e1d59f4"},{"_id":"public/vendors/font-awesome/css/font-awesome.css","modified":1445820063625,"shasum":"3b87c2560832748cd06f9bfd2fd6ea8edbdae8c7"},{"_id":"public/vendors/font-awesome/bower.json","modified":1445820063631,"shasum":"64394a2a9aa00f8e321d8daa5e51a420f0e96dad"},{"_id":"public/vendors/font-awesome/HELP-US-OUT.txt","modified":1445820063634,"shasum":"69a4c537d167b68a0ccf1c6febd138aeffca60d6"},{"_id":"public/vendors/fastclick/lib/fastclick.min.js","modified":1445820063637,"shasum":"2cae0f5a6c5d6f3cb993015e6863f9483fc4de18"},{"_id":"public/vendors/fastclick/lib/fastclick.js","modified":1445820063641,"shasum":"06cef196733a710e77ad7e386ced6963f092dc55"},{"_id":"public/vendors/fastclick/bower.json","modified":1445820063646,"shasum":"4dcecf83afddba148464d5339c93f6d0aa9f42e9"},{"_id":"public/vendors/fastclick/README.html","modified":1445820063655,"shasum":"4a6074903daa9004301ef30a6fb96556ba3eab60"},{"_id":"public/vendors/fastclick/LICENSE","modified":1445820063665,"shasum":"dcd5b6b43095d9e90353a28b09cb269de8d4838e"},{"_id":"public/vendors/fancybox/source/jquery.fancybox.pack.js","modified":1445820063668,"shasum":"53360764b429c212f424399384417ccc233bb3be"},{"_id":"public/vendors/fancybox/source/jquery.fancybox.js","modified":1445820063672,"shasum":"1cf3d47b5ccb7cb6e9019c64f2a88d03a64853e4"},{"_id":"public/vendors/fancybox/source/jquery.fancybox.css","modified":1445820063675,"shasum":"5f163444617b6cf267342f06ac166a237bb62df9"},{"_id":"public/vendors/fancybox/source/helpers/jquery.fancybox-thumbs.js","modified":1445820063679,"shasum":"53e194f4a72e649c04fb586dd57762b8c022800b"},{"_id":"public/vendors/fancybox/source/helpers/jquery.fancybox-thumbs.css","modified":1445820063682,"shasum":"4ac329c16a5277592fc12a37cca3d72ca4ec292f"},{"_id":"public/vendors/fancybox/source/helpers/jquery.fancybox-media.js","modified":1445820063686,"shasum":"3bdf69ed2469e4fb57f5a95f17300eef891ff90d"},{"_id":"public/vendors/fancybox/source/helpers/jquery.fancybox-buttons.js","modified":1445820063690,"shasum":"91e41741c2e93f732c82aaacec4cfc6e3f3ec876"},{"_id":"public/vendors/fancybox/source/helpers/jquery.fancybox-buttons.css","modified":1445820063694,"shasum":"1a9d8e5c22b371fcc69d4dbbb823d9c39f04c0c8"},{"_id":"public/vendors/fancybox/source/helpers/fancybox_buttons.png","modified":1445820063698,"shasum":"e385b139516c6813dcd64b8fc431c364ceafe5f3"},{"_id":"public/vendors/fancybox/source/fancybox_sprite@2x.png","modified":1445820063701,"shasum":"30c58913f327e28f466a00f4c1ac8001b560aed8"},{"_id":"public/vendors/fancybox/source/fancybox_sprite.png","modified":1445820063704,"shasum":"17df19f97628e77be09c352bf27425faea248251"},{"_id":"public/vendors/fancybox/source/fancybox_overlay.png","modified":1445820063709,"shasum":"b3a4ee645ba494f52840ef8412015ba0f465dbe0"},{"_id":"public/vendors/fancybox/source/fancybox_loading@2x.gif","modified":1445820063713,"shasum":"273b123496a42ba45c3416adb027cd99745058b0"},{"_id":"public/vendors/fancybox/source/fancybox_loading.gif","modified":1445820063716,"shasum":"1a755fb2599f3a313cc6cfdb14df043f8c14a99c"},{"_id":"public/vendors/fancybox/source/blank.gif","modified":1445820063719,"shasum":"2daeaa8b5f19f0bc209d976c02bd6acb51b00b0a"},{"_id":"public/js/ua-parser.min.js","modified":1445820063727,"shasum":"38628e75e4412cc6f11074e03e1c6d257aae495b"},{"_id":"public/js/nav-toggle.js","modified":1445820063730,"shasum":"78b59f1beb12adea0d7f9bcf4377cb699963f220"},{"_id":"public/js/motion_global.js","modified":1445820063733,"shasum":"2322d677b3dbed5506f3b79ec3d1ebe7e019f115"},{"_id":"public/js/motion_fallback.js","modified":1445820063736,"shasum":"a767d522c65a8b2fbad49135c9332135c6785c3e"},{"_id":"public/js/lazyload.js","modified":1445820063739,"shasum":"b92e9acdc7afc15468314c03f4a643b0c93944cf"},{"_id":"public/js/hook-duoshuo.js","modified":1445820063741,"shasum":"c5db82a2549b6be51e58a69a6f1c2e5afef5a20e"},{"_id":"public/js/helpers.js","modified":1445820063745,"shasum":"c15216ef897334362789ba37464298948b2eef95"},{"_id":"public/js/fancy-box.js","modified":1445820063749,"shasum":"62d38913d8e8a5736ecc48a0b343f67e86a0ae32"},{"_id":"public/js/bootstrap.scrollspy.js","modified":1445820063753,"shasum":"ae7bdce88b515aade4eea8bf7407eec458bcd625"},{"_id":"public/images/searchicon.png","modified":1445820063756,"shasum":"67727a6a969be0b2659b908518fa6706eed307b8"},{"_id":"public/images/quote-r.svg","modified":1445820063761,"shasum":"e60ae504f9d99b712c793c3740c6b100d057d4ec"},{"_id":"public/images/quote-l.svg","modified":1445820063764,"shasum":"94e870b4c8c48da61d09522196d4dd40e277a98f"},{"_id":"public/images/placeholder.gif","modified":1445820063767,"shasum":"5fbd472222feb8a22cf5b8aa5dc5b8e13af88e2b"},{"_id":"public/images/loading.gif","modified":1445820063770,"shasum":"5fbd472222feb8a22cf5b8aa5dc5b8e13af88e2b"},{"_id":"public/images/cc-zero.svg","modified":1445820063775,"shasum":"87669bf8ac268a91d027a0a4802c92a1473e9030"},{"_id":"public/images/cc-by.svg","modified":1445820063778,"shasum":"28a0a4fe355a974a5e42f68031652b76798d4f7e"},{"_id":"public/images/cc-by-sa.svg","modified":1445820063782,"shasum":"aa4742d733c8af8d38d4c183b8adbdcab045872e"},{"_id":"public/images/cc-by-nd.svg","modified":1445820063784,"shasum":"c563508ce9ced1e66948024ba1153400ac0e0621"},{"_id":"public/images/cc-by-nc.svg","modified":1445820063787,"shasum":"8d39b39d88f8501c0d27f8df9aae47136ebc59b7"},{"_id":"public/images/cc-by-nc-sa.svg","modified":1445820063790,"shasum":"3031be41e8753c70508aa88e84ed8f4f653f157e"},{"_id":"public/images/cc-by-nc-nd.svg","modified":1445820063793,"shasum":"c6524ece3f8039a5f612feaf865d21ec8a794564"},{"_id":"public/images/bkdefault_avatar.jpg","modified":1445820063816,"shasum":"b687bb4bfbe35a32b592c24d652ba80cfdc770fc"},{"_id":"public/fonts/icon-linecons/selection.json","modified":1445820063819,"shasum":"68da6ea1b3ab9355d42694bf5745071cdefa4a65"},{"_id":"public/fonts/icon-linecons/icomoon.woff","modified":1445820063822,"shasum":"0b07ee6ceda3b1bceb40c1e7379b3aa48dcc15a8"},{"_id":"public/fonts/icon-linecons/icomoon.ttf","modified":1445820063852,"shasum":"078068206684e4f185b0187ad3cee16f54a287d7"},{"_id":"public/fonts/icon-linecons/icomoon.svg","modified":1445820063854,"shasum":"808eaf7d61f7e67c76976265c885e79c36920f0b"},{"_id":"public/fonts/icon-linecons/icomoon.eot","modified":1445820063857,"shasum":"e2d7f040428a632f3c50bfa94083b759936effc2"},{"_id":"public/fonts/icon-icomoon/icomoon.woff","modified":1445820063861,"shasum":"05f1ec0bd307da5e731a86eb4961589a6042aebb"},{"_id":"public/fonts/icon-icomoon/icomoon.ttf","modified":1445820063865,"shasum":"f399713d1c9400d4d3373e38991a7e362a754a94"},{"_id":"public/fonts/icon-icomoon/icomoon.svg","modified":1445820063870,"shasum":"e316347805eb93425faa678611c5e42a7152da8f"},{"_id":"public/fonts/icon-icomoon/icomoon.eot","modified":1445820063873,"shasum":"301fcf00c24750dddf1c529f944ca62c7f1a217d"},{"_id":"public/fonts/icon-fifty-shades/selection.json","modified":1445820063880,"shasum":"e5a5042e8e516b1d30fa3b1206d2c74921cec72b"},{"_id":"public/fonts/icon-fifty-shades/icomoon.woff","modified":1445820063884,"shasum":"4de6a74f523dee33d95dde61caae5809f9a5d448"},{"_id":"public/fonts/icon-fifty-shades/icomoon.ttf","modified":1445820063887,"shasum":"72fe82e1f3db52414eed706952d385af241cb196"},{"_id":"public/fonts/icon-fifty-shades/icomoon.svg","modified":1445820063889,"shasum":"1a4afd739e1f8eb8d430dbdd29e36a9999802e8d"},{"_id":"public/fonts/icon-fifty-shades/icomoon.eot","modified":1445820063894,"shasum":"da86ba5df72d1288de9e9633e5f528062dd427d5"},{"_id":"public/fonts/icon-feather/selection.json","modified":1445820063897,"shasum":"d95a90b0d541e48b049902090c0d008ad92b4115"},{"_id":"public/fonts/icon-feather/icomoon.woff","modified":1445820063903,"shasum":"2ea1c59c17422798e64ee6f4e9ce1f7aff1a06a5"},{"_id":"public/fonts/icon-feather/icomoon.ttf","modified":1445820063906,"shasum":"b2bbae4b613403cf61ad25037913378da1c07b8f"},{"_id":"public/fonts/icon-feather/icomoon.svg","modified":1445820063910,"shasum":"d5eb756eefda9b454dcb23c2b1cefd4051d18d41"},{"_id":"public/fonts/icon-feather/icomoon.eot","modified":1445820063913,"shasum":"11554b9e9d5b9f535ba96cbb27d45d8c8f1689fd"},{"_id":"public/fonts/icon-default/selection.json","modified":1445820063916,"shasum":"ff1b9b78eced4d0368d14cc192ac67a0dd498593"},{"_id":"public/fonts/icon-default/icomoon.woff","modified":1445820063921,"shasum":"dbe0368f2a65d87b13234cfea29d9783892fc7a8"},{"_id":"public/fonts/icon-default/icomoon.ttf","modified":1445820063924,"shasum":"c093408e6030221cafc1f79d897f1fb5283c1178"},{"_id":"public/fonts/icon-default/icomoon.svg","modified":1445820063927,"shasum":"f92ad8cddc250f0bb5ca466fca95d321987e127e"},{"_id":"public/fonts/icon-default/icomoon.eot","modified":1445820063931,"shasum":"90763e97be18be78e65749075225cceeddc6fa8a"},{"_id":"public/css/main.css","modified":1445820064189,"shasum":"d4febfd2e3dafa1e84fe1b305a5989b7703623cb"},{"_id":"public/CNAME","modified":1445820064306,"shasum":"58a245e5291e156ffab1f3b84219930adbdf45d2"},{"_id":"public/404.html","modified":1445820203667,"shasum":"6c604b4237d6c136bd6c414f8668f01432978307"},{"_id":"public/tags/index.html","modified":1445820203699,"shasum":"876f774be33d57c3f54c0e185d28dcfbb52cf724"},{"_id":"public/2015/10/24/MQTT-V1-3-协议详解/index.html","modified":1445820203761,"shasum":"f1b13e06075d4bfb5084c74d9f78f1d6d90842ba"},{"_id":"public/2015/10/24/Erlang-Efficiency-guide-非标准笔记/index.html","modified":1445820203811,"shasum":"b1f594fbaf0210830bb669f6968b44c20cad89b6"},{"_id":"public/2015/10/22/Erlang通过NIF集成c代码示例/index.html","modified":1445820203872,"shasum":"ce596faed1231d72743f2d36c9abd8e0c885018b"},{"_id":"public/2015/10/22/Riak安装与MapReduce测试/index.html","modified":1445820203948,"shasum":"7807e28c9891d67a8d90552619b22afd4209a3e4"},{"_id":"public/2015/10/22/ejabberd-receiver分析/index.html","modified":1445820203995,"shasum":"5dbdf79e4099ed823c3260b9e9950fa40845da0c"},{"_id":"public/2015/10/22/Cowboy的路由机制/index.html","modified":1445820204071,"shasum":"9c42c7c42535e25eae233b876f605bfca3b59735"},{"_id":"public/2015/10/22/Erlang发送邮件相关问题/index.html","modified":1445820204130,"shasum":"833a3f8936057b772b8621808f1ac5bdb24ee738"},{"_id":"public/archives/index.html","modified":1445820204225,"shasum":"0439be13ee4065ceadfd1399d4f32761dbbd7419"},{"_id":"public/archives/2015/index.html","modified":1445820204367,"shasum":"903c1dd43f4834a6b7b3af6a5c4a0deedc806e2b"},{"_id":"public/archives/2015/10/index.html","modified":1445820204416,"shasum":"c019474eff0bfceec94b77fdc92542569bcc89fc"},{"_id":"public/index.html","modified":1445820204476,"shasum":"e6415dfb43c1ff9c20176d891aea49a3043666c3"},{"_id":"public/tags/Ejabberd/index.html","modified":1445820204503,"shasum":"09c373367705019a39c8b673c66237c6e0a17b6b"},{"_id":"public/tags/Riak/index.html","modified":1445820204544,"shasum":"3808f4147a3645ff0668345f1dedfae3d48ad8fb"},{"_id":"public/tags/MapReduce/index.html","modified":1445820204575,"shasum":"e6c86d807b2b74c7b4078eb33f02d8cc6c52ffa7"},{"_id":"public/tags/mqtt/index.html","modified":1445820204612,"shasum":"06b3e9c3f839898cc1e0f600aa6a49035380bd76"},{"_id":"public/tags/Erlang/index.html","modified":1445820204647,"shasum":"83727ce9146fbbb355048d237a51f3d1d88e8e1a"},{"_id":"public/tags/Cowboy/index.html","modified":1445820204697,"shasum":"a46bca9ccbcc09d120c09b9bfa11d6719423b08c"},{"_id":"public/sitemap.xml","modified":1445820380187,"shasum":"5e1bc687aac759e9793b5198f6380dd9a958af56"}],"Category":[],"Data":[],"Page":[{"_content":"<!DOCTYPE HTML>\n<html>\n<head>\n  <meta http-equiv=\"content-type\" content=\"text/html;charset=utf-8;\"/>\n  <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge,chrome=1\" />\n  <meta name=\"robots\" content=\"all\" />\n  <meta name=\"robots\" content=\"index,follow\"/>\n</head>\n<body>\n\n<script type=\"text/javascript\" src=\"http://www.qq.com/404/search_children.js\" charset=\"utf-8\" homePageUrl=\"your site url \" homePageName=\"回到我的主页\"></script>\n\n</body>\n</html>\n","source":"404.html","raw":"<!DOCTYPE HTML>\n<html>\n<head>\n  <meta http-equiv=\"content-type\" content=\"text/html;charset=utf-8;\"/>\n  <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge,chrome=1\" />\n  <meta name=\"robots\" content=\"all\" />\n  <meta name=\"robots\" content=\"index,follow\"/>\n</head>\n<body>\n\n<script type=\"text/javascript\" src=\"http://www.qq.com/404/search_children.js\" charset=\"utf-8\" homePageUrl=\"your site url \" homePageName=\"回到我的主页\"></script>\n\n</body>\n</html>\n","date":"2015-10-24T06:42:15.000Z","updated":"2015-10-24T06:42:15.000Z","path":"404.html","title":"","comments":1,"layout":"page","_id":"cig77xo5x0000i9s670e88zd9"},{"title":"tags","date":"2015-10-22T10:26:39.000Z","type":"tags","comment":false,"_content":"","source":"tags/index.md","raw":"title: tags\ndate: 2015-10-22 18:26:39\ntype: \"tags\"\ncomment: false\n---\n","updated":"2015-10-22T10:27:16.000Z","path":"tags/index.html","comments":1,"layout":"page","_id":"cig77xo920001i9s6em8hgme5"}],"Post":[{"title":"ejabberd_receiver分析","date":"2015-10-22T12:10:51.000Z","_content":"\nejabberd_receiver 分析\n=====\n`ejabberd_receiver`是ejabberd 中 网关层的数据receive模块，客户端发送的数据通过`ejabberd_receiver` 接收并通过xml port解析后发送给 ejabberd_c2s的实例处理，至于它的加密、压缩、解压之类的就不说了。\n\n主要说一下这个shaper（字母翻译：脉冲整形器，个人理解，流量控制）机制,什么意思呢？\n\n原来 `ejabberd_receiver`会根据本次socket接收到的包的大小，判断是否需要缓冲一会再接收下一个socket包，这里用到了socket参数`{active, once}`\n\n算法如下：\n    根据本次收到的包的大小 和 maxrate 算出应该缓冲多少s，再算出上一次 到 本次接收数据包的时间间隔来决定是否需要缓冲。\n\nshaper:update/2:\n\n```erlang\nupdate(none, _Size) -> {none, 0};\nupdate(#maxrate{} = State, Size) ->\n    MinInterv = 1000 * Size /(2 * State#maxrate.maxrate - State#maxrate.lastrate),\n    Interv = (now_to_usec(now()) - State#maxrate.lasttime) /1000, \n    ?DEBUG(\"State: ~p, Size=~p~nM=~p, I=~p~n\",\n    [State, Size, MinInterv, Interv]),\n    Pause = if \n                MinInterv > Interv ->\n                    1 + trunc(MinInterv - Interv);\n                true -> 0\n            end,\n    NextNow = now_to_usec(now()) + Pause * 1000,\n    {State#maxrate{lastrate =(State#maxrate.lastrate + 1000000 * Size / (NextNow - State#maxrate.lasttime)) / 2, lasttime = NextNow},\n    Pause}.\n```\n\nejabberd_receive:process_date/2\n\n```erlang\nprocess_data(Data,#state{xml_stream_state = XMLStreamState,shaper_state = ShaperState, c2s_pid = C2SPid} =State) ->\n    ?DEBUG(\"Received XML on stream = ~p\", [(Data)]),\n    XMLStreamState1 = xml_stream:parse(XMLStreamState, Data),\n    lager:info(\"XMLStreamState1 ~p\",[XMLStreamState1]),\n    {NewShaperState, Pause} = shaper:update(ShaperState, byte_size(Data)),\n    lager:info(\"pause :~p \\n pid :~p\",[Pause,C2SPid]),\n    if\n        C2SPid == undefined ->\n            ok;\n        Pause > 0 ->\n            erlang:start_timer(Pause, self(), activate);\n        true ->\n            activate_socket(State)\n    end,\n    State#state{xml_stream_state = XMLStreamState1,shaper_state = NewShaperState}.\n```\n","source":"_posts/ejabberd-receiver分析.md","raw":"title: ejabberd_receiver分析\ndate: 2015-10-22 20:10:51\ntags: [Ejabberd]\n---\n\nejabberd_receiver 分析\n=====\n`ejabberd_receiver`是ejabberd 中 网关层的数据receive模块，客户端发送的数据通过`ejabberd_receiver` 接收并通过xml port解析后发送给 ejabberd_c2s的实例处理，至于它的加密、压缩、解压之类的就不说了。\n\n主要说一下这个shaper（字母翻译：脉冲整形器，个人理解，流量控制）机制,什么意思呢？\n\n原来 `ejabberd_receiver`会根据本次socket接收到的包的大小，判断是否需要缓冲一会再接收下一个socket包，这里用到了socket参数`{active, once}`\n\n算法如下：\n    根据本次收到的包的大小 和 maxrate 算出应该缓冲多少s，再算出上一次 到 本次接收数据包的时间间隔来决定是否需要缓冲。\n\nshaper:update/2:\n\n```erlang\nupdate(none, _Size) -> {none, 0};\nupdate(#maxrate{} = State, Size) ->\n    MinInterv = 1000 * Size /(2 * State#maxrate.maxrate - State#maxrate.lastrate),\n    Interv = (now_to_usec(now()) - State#maxrate.lasttime) /1000, \n    ?DEBUG(\"State: ~p, Size=~p~nM=~p, I=~p~n\",\n    [State, Size, MinInterv, Interv]),\n    Pause = if \n                MinInterv > Interv ->\n                    1 + trunc(MinInterv - Interv);\n                true -> 0\n            end,\n    NextNow = now_to_usec(now()) + Pause * 1000,\n    {State#maxrate{lastrate =(State#maxrate.lastrate + 1000000 * Size / (NextNow - State#maxrate.lasttime)) / 2, lasttime = NextNow},\n    Pause}.\n```\n\nejabberd_receive:process_date/2\n\n```erlang\nprocess_data(Data,#state{xml_stream_state = XMLStreamState,shaper_state = ShaperState, c2s_pid = C2SPid} =State) ->\n    ?DEBUG(\"Received XML on stream = ~p\", [(Data)]),\n    XMLStreamState1 = xml_stream:parse(XMLStreamState, Data),\n    lager:info(\"XMLStreamState1 ~p\",[XMLStreamState1]),\n    {NewShaperState, Pause} = shaper:update(ShaperState, byte_size(Data)),\n    lager:info(\"pause :~p \\n pid :~p\",[Pause,C2SPid]),\n    if\n        C2SPid == undefined ->\n            ok;\n        Pause > 0 ->\n            erlang:start_timer(Pause, self(), activate);\n        true ->\n            activate_socket(State)\n    end,\n    State#state{xml_stream_state = XMLStreamState1,shaper_state = NewShaperState}.\n```\n","slug":"ejabberd-receiver分析","published":1,"updated":"2015-10-22T12:11:20.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cig77xo9w0002i9s63hw0hsb4"},{"title":"Riak安装与MapReduce测试","date":"2015-10-22T12:33:37.000Z","_content":"Riak安装与MapReduce测试\n===\n1.安装环境:\n=====\n1. Ubuntu 14.04\n2. riak-2.1.1 源码编译\n3. erlang版本R16B03-1(注意 riak目前还不支持R17以上的erlang 版本)\n\n2.依赖安装\n=====\n1. ssl :sudo apt-get install libssl0.9.8\n2. pam library: sudo apt-get install libpam0g-dev\n\n3.下载并编译riak\n=====\n1. 下载:`wget http://s3.amazonaws.com/downloads.basho.com/riak/2.1/2.1.1/riak-2.1.1.tar.gz`\n2. 解压:`tar zxvf riak-2.1.1.tar.gz`\n3. 编译:`cd riak-2.1.1 && make`\n\n4.构建riak集群\n=====\n1. 生成riak node实例:`make devrel DEVNODES=$N`,其中N是想要生成的节点数\n2. 配置riak node ：riak的配置文件位于 $RIAK_HOME/dev/dev*/etc/riak.conf,可以配置节点名称,HTTP服务监听IP和端口,PCB 协议监听IP和端口storage backend(存储后端) 等。\n3. 启动riak node :`$RIAK_NODE_ROOT/bin/riak start`\n4. 组成集群\n\n  1. 加入集群： `$RIAK_NODE_ROOT/bin/riak-admin cluster join $NODENAME`\n  2. `$RIAK_NODE_ROOT/bin/riak-admin cluster plan`\n  3. 提交:`$RIAK_NODE_ROOT/bin/riak-admin cluster commit`\n  4. 查看集群状态:`$RIAK_NODE_ROOT/bin/riak-admin member-status`\n\n5.相关官方文档\n=====\n1. riak.conf 配置文件：`http://docs.basho.com/riak/2.1.1/ops/building/configuration/`\n2. riak和riak-admin:`http://docs.basho.com/riak/2.1.1/ops/running/tools/riak/` 、`http://docs.basho.com/riak/2.1.1/ops/running/tools/riak-admin/`\n3. 存储后端的选择：`http://docs.basho.com/riak/latest/ops/building/planning/backends/`\n4. MapReduce:`http://docs.basho.com/riak/2.1.1/dev/advanced/mapreduce/`\n\n6.MapReduce 实践\n=====\nMapReduce是Riak主要用于非主键查询的方法，但是MapReduce 操作的代价是十分昂贵的，甚至会降低生产环境集群的性能。因此，应当尽量少用MapReduce，并且永远不要用于实时查询。Riak允许你通过Erlang或者Javascript来进行MapReduce操作，但是从Riak2.0开始，javascript开始被弃用。\nMapReduce测试：\n五台机器，组成集群：\n一台 \nmodel name      : Intel(R) Core(TM) i5-4460  CPU @ 3.20GHz\nMemTotal:        1429236 kB\n四台\nIntel(R) Xeon(R) CPU E5-2620 0 @ 2.00GHz\nMemTotal:       65897328 kB\n\n\n在erlang shell里面输入：\n```erlang\n    {A,B,C}=erlang:now(),\n    {ok, Soc1} = riakc_pb_socket:start_link(\"127.0.0.1\", 10017),\n    Map =fun(V, _, _) ->\n        {struct, PropList} = mochijson2:decode(riak_object:get_value(V)),\n        U = proplists:get_value(<<\"user_id\">>, PropList),\n        [dict:from_list([{U, 1}])]\n    end,\n    Reduce = fun(Results, _) ->\n        Return =\n        lists:foldl(fun(D, Acc) ->\n        dict:merge(fun(_, X, Y) -> X + Y end, D, Acc)\n        end, dict:new(), lists:flatten([Results])),\n        [Return]\n    end,\n    Reslut = riakc_pb_socket:mapred_bucket(Soc1, <<\"user_read_log4\">>, [{map, {qfun, Map}, none, false}, {reduce, {qfun, \t\tReduce}, none, true}], 6000000),\n    {A1,B1,C1}=erlang:now(),\n    (A1* 1000000000000 + B1*1000000 + C1)  - (A* 1000000000000 + B*1000000+ C).\n```\n\n%通过PCB接口，使用erlang进行MapReduce处理 240080 条数据，耗时 62112283 微秒，约等于 62s\n\n```shell\n  root@localhost:/data/riak-2.1.1# date +%s\n\t1442537754\n\troot@localhost:/data/riak-2.1.1# curl -XPOST -H\"content-type: application/json\"\\\n        http://localhost:10018/mapred --data @-<<\\EOF\n    \t{\"inputs\":\"user_read_log4\",\"query\":[{\"map\":{\"language\":\"javascript\",\"source\":\"\n    \tfunction(v) {\n    \tvar data=Riak.mapValuesJson(v)[0];\n    \tvar r={};\n    \tr[data.user_id]=1;\n   \treturn [r];\n    \t}\",\"keep\":false}},\n    \t{\"reduce\":{\"language\":\"javascript\",\"source\":\"\n    \tfunction(v){\n                    var i, j, r = {}, w;\n                for (i = 0; i < v.length; i += 1) {\n                    for (w in v[i]) {\n                        if (v[i].hasOwnProperty(w)) {\n                            if (r[w]) { r[w] += v[i][w]; }\n                            else { r[w] = v[i][w]; }\n                        }\n                    }\n                }\n                return [r];\n    \t}\"\n    \t}}],\"timeout\":1000000}\n \tEOF\n\troot@localhost:/data/riak-2.1.1# date +%s\n\t1442538003\n```\n\n\n%通过http接口，使用javascript 进行Mapreduce 处理240080 条数据，1442538003-1442537754=249s\n\n```erlang\n\tmap_javascript()->\n    \t{A,B,C}=erlang:now(),\n    \t{ok, Soc1} = riakc_pb_socket:start_link(\"127.0.0.1\", 10017),\n    \tMap= <<\"function(v) { var data=Riak.mapValuesJson(v)[0];var r={};r[data.user_id]=1;return [r];}\">>,\n    \tReduce= <<\"function(v){var i, j, r = {}, w;for (i = 0; i < v.length; i += 1) {for (w in v[i]) \\\n           {if (v[i].hasOwnProperty(w)) {if (r[w]) { r[w] += v[i][w]; }else { r[w] = v[i][w]; }}}}return [r];}\" >>,\n    \tResult=riakc_pb_socket:mapred_bucket(Soc1, <<\"user_read_log4\">>, [{map, {jsanon, Map}, none, false}, {reduce, {jsanon, Reduce}, none, true}], 6000000),\n    \t{A1,B1,C1}=erlang:now(),\n    \t{Result,(A1* 1000000000000 + B1*1000000 + C1)  - (A* 1000000000000 + B*1000000+ C)}.\n\n\t(book_club_server@localhost)11> bus_user_read_behaviortrace_handler:map_javascript().\n\t{{ok,[{1,\n       \t[{struct,[{<<\"201507301601028734\">>,27301},\n                 {<<\"201507301601028728\">>,26948},\n                 {<<\"201507301601028735\">>,23250},\n                 {<<\"201507301601028733\">>,27156},\n                 {<<\"201507301601028730\">>,27175},\n                 {<<\"201507301601028732\">>,26993},\n                 {<<\"201507301601028727\">>,26930},\n                 {<<\"201507301601028729\">>,27177},\n                 {<<\"201507301601028731\">>,27150}]}]}]},240914091}\n```\n%通过PCB协议接口，使用Javascript 进行MapReduce处理240080 条数据，耗时 240914091微妙 ，约240秒.\n```\n\n\n通过上面的测试，我们就可以知道为什么Riak自己都不推荐使用Javascript 进行MapReduce了，使用Erlang  的进行MapReduce的效率几乎是 javascript 的4倍。\n\n\n\n","source":"_posts/Riak安装与MapReduce测试.md","raw":"title: Riak安装与MapReduce测试\ndate: 2015-10-22 20:33:37\ntags: [Riak,MapReduce]\n---\nRiak安装与MapReduce测试\n===\n1.安装环境:\n=====\n1. Ubuntu 14.04\n2. riak-2.1.1 源码编译\n3. erlang版本R16B03-1(注意 riak目前还不支持R17以上的erlang 版本)\n\n2.依赖安装\n=====\n1. ssl :sudo apt-get install libssl0.9.8\n2. pam library: sudo apt-get install libpam0g-dev\n\n3.下载并编译riak\n=====\n1. 下载:`wget http://s3.amazonaws.com/downloads.basho.com/riak/2.1/2.1.1/riak-2.1.1.tar.gz`\n2. 解压:`tar zxvf riak-2.1.1.tar.gz`\n3. 编译:`cd riak-2.1.1 && make`\n\n4.构建riak集群\n=====\n1. 生成riak node实例:`make devrel DEVNODES=$N`,其中N是想要生成的节点数\n2. 配置riak node ：riak的配置文件位于 $RIAK_HOME/dev/dev*/etc/riak.conf,可以配置节点名称,HTTP服务监听IP和端口,PCB 协议监听IP和端口storage backend(存储后端) 等。\n3. 启动riak node :`$RIAK_NODE_ROOT/bin/riak start`\n4. 组成集群\n\n  1. 加入集群： `$RIAK_NODE_ROOT/bin/riak-admin cluster join $NODENAME`\n  2. `$RIAK_NODE_ROOT/bin/riak-admin cluster plan`\n  3. 提交:`$RIAK_NODE_ROOT/bin/riak-admin cluster commit`\n  4. 查看集群状态:`$RIAK_NODE_ROOT/bin/riak-admin member-status`\n\n5.相关官方文档\n=====\n1. riak.conf 配置文件：`http://docs.basho.com/riak/2.1.1/ops/building/configuration/`\n2. riak和riak-admin:`http://docs.basho.com/riak/2.1.1/ops/running/tools/riak/` 、`http://docs.basho.com/riak/2.1.1/ops/running/tools/riak-admin/`\n3. 存储后端的选择：`http://docs.basho.com/riak/latest/ops/building/planning/backends/`\n4. MapReduce:`http://docs.basho.com/riak/2.1.1/dev/advanced/mapreduce/`\n\n6.MapReduce 实践\n=====\nMapReduce是Riak主要用于非主键查询的方法，但是MapReduce 操作的代价是十分昂贵的，甚至会降低生产环境集群的性能。因此，应当尽量少用MapReduce，并且永远不要用于实时查询。Riak允许你通过Erlang或者Javascript来进行MapReduce操作，但是从Riak2.0开始，javascript开始被弃用。\nMapReduce测试：\n五台机器，组成集群：\n一台 \nmodel name      : Intel(R) Core(TM) i5-4460  CPU @ 3.20GHz\nMemTotal:        1429236 kB\n四台\nIntel(R) Xeon(R) CPU E5-2620 0 @ 2.00GHz\nMemTotal:       65897328 kB\n\n\n在erlang shell里面输入：\n```erlang\n    {A,B,C}=erlang:now(),\n    {ok, Soc1} = riakc_pb_socket:start_link(\"127.0.0.1\", 10017),\n    Map =fun(V, _, _) ->\n        {struct, PropList} = mochijson2:decode(riak_object:get_value(V)),\n        U = proplists:get_value(<<\"user_id\">>, PropList),\n        [dict:from_list([{U, 1}])]\n    end,\n    Reduce = fun(Results, _) ->\n        Return =\n        lists:foldl(fun(D, Acc) ->\n        dict:merge(fun(_, X, Y) -> X + Y end, D, Acc)\n        end, dict:new(), lists:flatten([Results])),\n        [Return]\n    end,\n    Reslut = riakc_pb_socket:mapred_bucket(Soc1, <<\"user_read_log4\">>, [{map, {qfun, Map}, none, false}, {reduce, {qfun, \t\tReduce}, none, true}], 6000000),\n    {A1,B1,C1}=erlang:now(),\n    (A1* 1000000000000 + B1*1000000 + C1)  - (A* 1000000000000 + B*1000000+ C).\n```\n\n%通过PCB接口，使用erlang进行MapReduce处理 240080 条数据，耗时 62112283 微秒，约等于 62s\n\n```shell\n  root@localhost:/data/riak-2.1.1# date +%s\n\t1442537754\n\troot@localhost:/data/riak-2.1.1# curl -XPOST -H\"content-type: application/json\"\\\n        http://localhost:10018/mapred --data @-<<\\EOF\n    \t{\"inputs\":\"user_read_log4\",\"query\":[{\"map\":{\"language\":\"javascript\",\"source\":\"\n    \tfunction(v) {\n    \tvar data=Riak.mapValuesJson(v)[0];\n    \tvar r={};\n    \tr[data.user_id]=1;\n   \treturn [r];\n    \t}\",\"keep\":false}},\n    \t{\"reduce\":{\"language\":\"javascript\",\"source\":\"\n    \tfunction(v){\n                    var i, j, r = {}, w;\n                for (i = 0; i < v.length; i += 1) {\n                    for (w in v[i]) {\n                        if (v[i].hasOwnProperty(w)) {\n                            if (r[w]) { r[w] += v[i][w]; }\n                            else { r[w] = v[i][w]; }\n                        }\n                    }\n                }\n                return [r];\n    \t}\"\n    \t}}],\"timeout\":1000000}\n \tEOF\n\troot@localhost:/data/riak-2.1.1# date +%s\n\t1442538003\n```\n\n\n%通过http接口，使用javascript 进行Mapreduce 处理240080 条数据，1442538003-1442537754=249s\n\n```erlang\n\tmap_javascript()->\n    \t{A,B,C}=erlang:now(),\n    \t{ok, Soc1} = riakc_pb_socket:start_link(\"127.0.0.1\", 10017),\n    \tMap= <<\"function(v) { var data=Riak.mapValuesJson(v)[0];var r={};r[data.user_id]=1;return [r];}\">>,\n    \tReduce= <<\"function(v){var i, j, r = {}, w;for (i = 0; i < v.length; i += 1) {for (w in v[i]) \\\n           {if (v[i].hasOwnProperty(w)) {if (r[w]) { r[w] += v[i][w]; }else { r[w] = v[i][w]; }}}}return [r];}\" >>,\n    \tResult=riakc_pb_socket:mapred_bucket(Soc1, <<\"user_read_log4\">>, [{map, {jsanon, Map}, none, false}, {reduce, {jsanon, Reduce}, none, true}], 6000000),\n    \t{A1,B1,C1}=erlang:now(),\n    \t{Result,(A1* 1000000000000 + B1*1000000 + C1)  - (A* 1000000000000 + B*1000000+ C)}.\n\n\t(book_club_server@localhost)11> bus_user_read_behaviortrace_handler:map_javascript().\n\t{{ok,[{1,\n       \t[{struct,[{<<\"201507301601028734\">>,27301},\n                 {<<\"201507301601028728\">>,26948},\n                 {<<\"201507301601028735\">>,23250},\n                 {<<\"201507301601028733\">>,27156},\n                 {<<\"201507301601028730\">>,27175},\n                 {<<\"201507301601028732\">>,26993},\n                 {<<\"201507301601028727\">>,26930},\n                 {<<\"201507301601028729\">>,27177},\n                 {<<\"201507301601028731\">>,27150}]}]}]},240914091}\n```\n%通过PCB协议接口，使用Javascript 进行MapReduce处理240080 条数据，耗时 240914091微妙 ，约240秒.\n```\n\n\n通过上面的测试，我们就可以知道为什么Riak自己都不推荐使用Javascript 进行MapReduce了，使用Erlang  的进行MapReduce的效率几乎是 javascript 的4倍。\n\n\n\n","slug":"Riak安装与MapReduce测试","published":1,"updated":"2015-10-22T12:34:02.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cig77xoag0005i9s6s8dv9toh"},{"title":"MQTT_V1.3_协议详解","date":"2015-10-24T06:34:53.000Z","_content":"MQTT 协议详解\n====\n\n预览\n====\n    %%        7   6   5   4      3     2   1      0\n    byte1     message_type   dupflag   QoSLV   RETAIN\n    byte2     Remaining Length\n    byte3      Variable header\n    byten       ....\n                    MSG\n\nFixed header（固定头部）\n====\n    %%        7   6   5   4      3     2   1      0\n    byte1     message_type   dupflag   QoSLV   RETAIN\n    byte2     Remaining Length\n\n* message_type:消息类型，第4-7位比特，不同的值表示不同的意思，具体如下：\n    1. 1 ：CONNECT,客户端请求连接服务器\t       \n    2. 2 : CONNACK,连接应答\n    3. 3 ：PUBLISH ,发布一条消息      \t\n    4. 4 :  PUBACK, 发布应答        \t\n    5. 5 :  PUBREC, 发布被接收应答发布1        \t\n    6. 6 ：PUBREL ，发布释放应答发布2        \t\n    7. 7 : PUBCOMP,发布完成应答发布3        \t\n    8. 8 ：SUBSCRIBE,请求订阅        \t\n    9. 9 ：SUBACK,订阅应答        \t\n    10. 10 ：UNSUBSCRIBE ,取消订阅\n    11. 11 ：unsuback,取消订阅应答\n    12. 12 ：PINGREQ ,ping请求\n    13. 13 ：PINGRESP,ping回应\n    14. 14 ：DISCONNECT,客户端断开连接\n    15. 15 ：保留\n\n* DUP:用于标识是否是重发的发布，发布应答，订阅，取消订阅的消息，当QoS大于0，且设置必须应答时。\n* QoS:消息的发送保证级别；0：至多一次，1：至少1次 ；2：只有一次 3：保留\n* RETAIN：对发布消息有用，为1时标识发布的消息对新订阅的用户有用，且需要持久化，\n* Remaining Length:低7位为消息的字节数量，第8位为下一个字节也是长度标志位，最大为四个字节。\n\n\nVariable Header(可变头部)\n====\n某些MQTT的命令会包含一个可变的头部组件，它位于 固定头部（fixed header)和负载之间。\nProtocol name(协议名称）\n====\n协议名出现在一条MQTT 连接消息的可变头部中，这个字段是UTF编码，比如 MQIsdp 或MQTT\n\nProtocol version（协议版本）\n====\n协议版本字段出先在一条MQTT连接消息的可变头部中，占用一个字节。\n\nConnect flag（连接标识）\n====\nClean_session,WILL,Will QoS,Retain flags 出现在CONNECT 消息的可变头部。\n\nClean session flag\n====\n位置：在connect flag字节的 第1位（从0位开始），如果该位不置1则服务器需要持久化该客户端的订阅消息，以便下一次连接后继续使用。如果置1，则客户端断开后清空订阅信息，每次连接都需要重新订阅信息。\n\nWill QoS、Will flag 、Will Message\n====\n位置：在connect flag 字节的第3 和第4位\n這三個flag，就是在MQTT簡介裡被提到的 最後遺囑(Last Will and Testament) 機制所用的flag。這機制是這樣的，client在一開始發送CONNECT訊息給server要求建立連線時，就把要對哪個主題說什麼遺言一起傳給server，當它在不正常的情況下斷線時(比如說網路連線斷掉、裝置故障等等)，則這些訊息就會被server主動發佈到該主題上。如果是client主動發送DISCONNECT訊息給server要求斷線時，則此機制將不會有作用。\n\n要啟動此機制，首先就是要將Will flag設為1，這樣就代表要啟用，之後你設定遺言的QoS level為何，server會依照你設定的QoS level來幫你傳送訊息，最後設定此此則遺言是否要保留(Retain)在server上。如果有設定Will flag，則在pyaload內會需要定義Will Topic和Will Message，也就是要對哪個主題發送什麼樣的遺言。\n\nUser name 和 password 标识\n====\n位置：在connect flag 字节的第6和第7位\n客户端在连接时指明是否包含了登陆名称和登陆密码。\n\nKeep Alive timer（存活定时器）\n====\nkeep alive timer 出现在一个CONNECT消息的可变头部，定义了从客户端接受消息的最大间隔时间（秒），可用于服务端心跳包机制来判断与客户端的网络连接是否已经断开。keep alive timer 字段大小为两个字节，0表示客户端用于不会断开。\n\nConnect return code 返回码\n====\nconnect return code出现 在CONNACK 消息中，大小为一个字节，当前有意义的值是：\n- 0x00 : 接受连接\n- 0x01:  拒绝连接，协议版本不可用\n- 0x02:  连接失败，标识拒绝\n- 0x03:  服务器连接失败\n- 0x04:  用户名和密码错误\n- 0x05:  没有验证\n\nTopic name (订阅名称）\n====\ntopic name 出现在MQTT PUBLISH 消息的可变头部，用来标明发布消息所属的channel，订阅时使用该值来标明从哪里接收发布消息。\n\n","source":"_posts/MQTT-V1-3-协议详解.md","raw":"title: MQTT_V1.3_协议详解\ndate: 2015-10-24 14:34:53\ntags: [mqtt]\n---\nMQTT 协议详解\n====\n\n预览\n====\n    %%        7   6   5   4      3     2   1      0\n    byte1     message_type   dupflag   QoSLV   RETAIN\n    byte2     Remaining Length\n    byte3      Variable header\n    byten       ....\n                    MSG\n\nFixed header（固定头部）\n====\n    %%        7   6   5   4      3     2   1      0\n    byte1     message_type   dupflag   QoSLV   RETAIN\n    byte2     Remaining Length\n\n* message_type:消息类型，第4-7位比特，不同的值表示不同的意思，具体如下：\n    1. 1 ：CONNECT,客户端请求连接服务器\t       \n    2. 2 : CONNACK,连接应答\n    3. 3 ：PUBLISH ,发布一条消息      \t\n    4. 4 :  PUBACK, 发布应答        \t\n    5. 5 :  PUBREC, 发布被接收应答发布1        \t\n    6. 6 ：PUBREL ，发布释放应答发布2        \t\n    7. 7 : PUBCOMP,发布完成应答发布3        \t\n    8. 8 ：SUBSCRIBE,请求订阅        \t\n    9. 9 ：SUBACK,订阅应答        \t\n    10. 10 ：UNSUBSCRIBE ,取消订阅\n    11. 11 ：unsuback,取消订阅应答\n    12. 12 ：PINGREQ ,ping请求\n    13. 13 ：PINGRESP,ping回应\n    14. 14 ：DISCONNECT,客户端断开连接\n    15. 15 ：保留\n\n* DUP:用于标识是否是重发的发布，发布应答，订阅，取消订阅的消息，当QoS大于0，且设置必须应答时。\n* QoS:消息的发送保证级别；0：至多一次，1：至少1次 ；2：只有一次 3：保留\n* RETAIN：对发布消息有用，为1时标识发布的消息对新订阅的用户有用，且需要持久化，\n* Remaining Length:低7位为消息的字节数量，第8位为下一个字节也是长度标志位，最大为四个字节。\n\n\nVariable Header(可变头部)\n====\n某些MQTT的命令会包含一个可变的头部组件，它位于 固定头部（fixed header)和负载之间。\nProtocol name(协议名称）\n====\n协议名出现在一条MQTT 连接消息的可变头部中，这个字段是UTF编码，比如 MQIsdp 或MQTT\n\nProtocol version（协议版本）\n====\n协议版本字段出先在一条MQTT连接消息的可变头部中，占用一个字节。\n\nConnect flag（连接标识）\n====\nClean_session,WILL,Will QoS,Retain flags 出现在CONNECT 消息的可变头部。\n\nClean session flag\n====\n位置：在connect flag字节的 第1位（从0位开始），如果该位不置1则服务器需要持久化该客户端的订阅消息，以便下一次连接后继续使用。如果置1，则客户端断开后清空订阅信息，每次连接都需要重新订阅信息。\n\nWill QoS、Will flag 、Will Message\n====\n位置：在connect flag 字节的第3 和第4位\n這三個flag，就是在MQTT簡介裡被提到的 最後遺囑(Last Will and Testament) 機制所用的flag。這機制是這樣的，client在一開始發送CONNECT訊息給server要求建立連線時，就把要對哪個主題說什麼遺言一起傳給server，當它在不正常的情況下斷線時(比如說網路連線斷掉、裝置故障等等)，則這些訊息就會被server主動發佈到該主題上。如果是client主動發送DISCONNECT訊息給server要求斷線時，則此機制將不會有作用。\n\n要啟動此機制，首先就是要將Will flag設為1，這樣就代表要啟用，之後你設定遺言的QoS level為何，server會依照你設定的QoS level來幫你傳送訊息，最後設定此此則遺言是否要保留(Retain)在server上。如果有設定Will flag，則在pyaload內會需要定義Will Topic和Will Message，也就是要對哪個主題發送什麼樣的遺言。\n\nUser name 和 password 标识\n====\n位置：在connect flag 字节的第6和第7位\n客户端在连接时指明是否包含了登陆名称和登陆密码。\n\nKeep Alive timer（存活定时器）\n====\nkeep alive timer 出现在一个CONNECT消息的可变头部，定义了从客户端接受消息的最大间隔时间（秒），可用于服务端心跳包机制来判断与客户端的网络连接是否已经断开。keep alive timer 字段大小为两个字节，0表示客户端用于不会断开。\n\nConnect return code 返回码\n====\nconnect return code出现 在CONNACK 消息中，大小为一个字节，当前有意义的值是：\n- 0x00 : 接受连接\n- 0x01:  拒绝连接，协议版本不可用\n- 0x02:  连接失败，标识拒绝\n- 0x03:  服务器连接失败\n- 0x04:  用户名和密码错误\n- 0x05:  没有验证\n\nTopic name (订阅名称）\n====\ntopic name 出现在MQTT PUBLISH 消息的可变头部，用来标明发布消息所属的channel，订阅时使用该值来标明从哪里接收发布消息。\n\n","slug":"MQTT-V1-3-协议详解","published":1,"updated":"2015-10-24T06:35:25.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cig77xoai000ai9s6zpyjn2yf"},{"title":"Erlang通过NIF集成c代码示例","date":"2015-10-22T13:24:21.000Z","_content":"\nERLANG NIF 编写\n===\n\n很多时候一下计算量大，效率要求很高的地方也许使用c会好于erlang。\n\nErlang层代码\n====\n-  通过 `-on_load`模块属性，实现erlang vm 加载模块时同时加载c的共享库文件。\n-   nif的函数erlang入口为 func(args) -> erlang:nif_error({error,not_loaded}).\n\nC层代码\n====\n- 包含 erl_nif.h  , `#include<erl_nif.h>`，\n- 注册NIF ,这里分为了三步：\n  1. ErlNifFunc 数组，告诉erlang vm 库中实现的NIF，以及erlang函数名对应的c实现函数:\n\tstatic ErlNifFunc test_nifs[] =\n\t{ \n \t{\"hello\",1,&hello_1} \n\t};\n  2. ERL_NIF_INIT宏 将 ErlNifFunc数组联同所属模块的模块名告诉Erlang vm。`ERL_NIF_INIT(test_nif,test_nifs,NULL,NULL,NULL,NULL);`\n  3. c实现函数 `static ERL_NIF_TERM hello_1(ErlNifEnv * env,int argc,const ERL_NIF_TERM argv[])` , 函数接受3个参数，并返回一个ERL_NIF_TERM对象，第一个参数env就是前面提到过的ErlNifEnv 指针。第二个参数argc是Erlang调用NIF时传入的参数数目。第三个参数argv中的元素就是传入的各个参数（数目与argc中的一致）。\n\n3.编译c代码\n   `gcc -o test_nif.so -fpic -shared -I/usr/local/lib/erlang/erts-5.10.4/include test_nif.c`.\n\ntest_nif.c\n\n```c\n#include<erl_nif.h>\n#include<string.h>\nstatic ERL_NIF_TERM hello_1(ErlNifEnv * env,int argc,const ERL_NIF_TERM argv[])\n{\n \treturn enif_make_tuple2(env,enif_make_atom(env,\"hello\"),argv[0]);\n}\nstatic ErlNifFunc test_nifs[] =\n{ \n \t{\"hello\",1,&hello_1} \n};\nERL_NIF_INIT(test_nif,test_nifs,NULL,NULL,NULL,NULL);\n```\n\ntest_nif.erl\n\n```erlang\n-module(test_nif).\n-on_load(init/0).\n-export([hello/1]).\ninit()->\n \terlang:load_nif(\"./test_nif\",0);\nhello(Arg)->\n \terlang:nif_error({error, not_loaded}).\n ```\n\n","source":"_posts/Erlang通过NIF集成c代码示例.md","raw":"title: Erlang通过NIF集成c代码示例\ndate: 2015-10-22 21:24:21\ntags: [Erlang]\n---\n\nERLANG NIF 编写\n===\n\n很多时候一下计算量大，效率要求很高的地方也许使用c会好于erlang。\n\nErlang层代码\n====\n-  通过 `-on_load`模块属性，实现erlang vm 加载模块时同时加载c的共享库文件。\n-   nif的函数erlang入口为 func(args) -> erlang:nif_error({error,not_loaded}).\n\nC层代码\n====\n- 包含 erl_nif.h  , `#include<erl_nif.h>`，\n- 注册NIF ,这里分为了三步：\n  1. ErlNifFunc 数组，告诉erlang vm 库中实现的NIF，以及erlang函数名对应的c实现函数:\n\tstatic ErlNifFunc test_nifs[] =\n\t{ \n \t{\"hello\",1,&hello_1} \n\t};\n  2. ERL_NIF_INIT宏 将 ErlNifFunc数组联同所属模块的模块名告诉Erlang vm。`ERL_NIF_INIT(test_nif,test_nifs,NULL,NULL,NULL,NULL);`\n  3. c实现函数 `static ERL_NIF_TERM hello_1(ErlNifEnv * env,int argc,const ERL_NIF_TERM argv[])` , 函数接受3个参数，并返回一个ERL_NIF_TERM对象，第一个参数env就是前面提到过的ErlNifEnv 指针。第二个参数argc是Erlang调用NIF时传入的参数数目。第三个参数argv中的元素就是传入的各个参数（数目与argc中的一致）。\n\n3.编译c代码\n   `gcc -o test_nif.so -fpic -shared -I/usr/local/lib/erlang/erts-5.10.4/include test_nif.c`.\n\ntest_nif.c\n\n```c\n#include<erl_nif.h>\n#include<string.h>\nstatic ERL_NIF_TERM hello_1(ErlNifEnv * env,int argc,const ERL_NIF_TERM argv[])\n{\n \treturn enif_make_tuple2(env,enif_make_atom(env,\"hello\"),argv[0]);\n}\nstatic ErlNifFunc test_nifs[] =\n{ \n \t{\"hello\",1,&hello_1} \n};\nERL_NIF_INIT(test_nif,test_nifs,NULL,NULL,NULL,NULL);\n```\n\ntest_nif.erl\n\n```erlang\n-module(test_nif).\n-on_load(init/0).\n-export([hello/1]).\ninit()->\n \terlang:load_nif(\"./test_nif\",0);\nhello(Arg)->\n \terlang:nif_error({error, not_loaded}).\n ```\n\n","slug":"Erlang通过NIF集成c代码示例","published":1,"updated":"2015-10-22T13:24:47.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cig77xoak000di9s6ewlxly3i"},{"title":"Erlang发送邮件相关问题","date":"2015-10-22T10:22:11.000Z","_content":"Erlang 发送邮件相关问题\n====\n\n1. 协议相关\n=====\n一封邮件的发送的协议格式如下：\n\n\t\"HELO XXX\\r\\n\"\n\t\"AUTH LOGIN \\r\\r\"\n\t\"$Account\\r\\n\" ($Account为账号需要经过base64 encoding）\n\t\"$Password\\r\\n\" ($Password 为密码需要经过base64 encoding)\n\t\"DATA\\r\\n\"\n\t\"From: < $Account> \\r\\n\" ($Account 为发送者的email\n\t\"To : < $ToEmails >\\r\\n\" ($ToEmails 为发送者的列表）\n\t\"Subject: =?UTF-8?B? $Tittle ?=\\r\\n\"($Tittle 是邮件标题经过base64 编码后的字符串，这样做的目的是为了避免中文乱码）\n\t\"MIME-version: 1.0\\r\\n\"\n\t\"Content-Type:text/html;charset=UTF-8\\r\\n\\r\\n\"\n\t\"$DATA\\r\\n\\r\\n\" (正文内容）\n\t\"\\r\\n.\\r\\n\"(结束）\n\t\"QUIT\\r\\n\"(退出）\n\n2.乱码问题\n=====\nErlang 处理中文，唯一办法就是转换成utf-8 ,所以在smtp协议里面就需要指明对应的编码，所以标题需要改为`\"Subject: =?UTF-8?B? $Tittle ?=\\r\\n\"($Tittle 是邮件标题经过base64编码后的字符串，这样做的目的是为了避免中文乱码)` , 正文部分需要指明charset ：`\"Content-Type:text/html;charset=UTF-8\\r\\n\\r\\n\"`\n\n3. 相关资料\n======\n- http://wdicc.com/sendmail-use-perl/\n- http://www.cnblogs.com/quitboy/p/4605694.html\n- http://www.chinaemail.com.cn/blog/content/667/\n","source":"_posts/Erlang发送邮件相关问题.md","raw":"title: Erlang发送邮件相关问题\ndate: 2015-10-22 18:22:11\ntags: [Erlang]\n---\nErlang 发送邮件相关问题\n====\n\n1. 协议相关\n=====\n一封邮件的发送的协议格式如下：\n\n\t\"HELO XXX\\r\\n\"\n\t\"AUTH LOGIN \\r\\r\"\n\t\"$Account\\r\\n\" ($Account为账号需要经过base64 encoding）\n\t\"$Password\\r\\n\" ($Password 为密码需要经过base64 encoding)\n\t\"DATA\\r\\n\"\n\t\"From: < $Account> \\r\\n\" ($Account 为发送者的email\n\t\"To : < $ToEmails >\\r\\n\" ($ToEmails 为发送者的列表）\n\t\"Subject: =?UTF-8?B? $Tittle ?=\\r\\n\"($Tittle 是邮件标题经过base64 编码后的字符串，这样做的目的是为了避免中文乱码）\n\t\"MIME-version: 1.0\\r\\n\"\n\t\"Content-Type:text/html;charset=UTF-8\\r\\n\\r\\n\"\n\t\"$DATA\\r\\n\\r\\n\" (正文内容）\n\t\"\\r\\n.\\r\\n\"(结束）\n\t\"QUIT\\r\\n\"(退出）\n\n2.乱码问题\n=====\nErlang 处理中文，唯一办法就是转换成utf-8 ,所以在smtp协议里面就需要指明对应的编码，所以标题需要改为`\"Subject: =?UTF-8?B? $Tittle ?=\\r\\n\"($Tittle 是邮件标题经过base64编码后的字符串，这样做的目的是为了避免中文乱码)` , 正文部分需要指明charset ：`\"Content-Type:text/html;charset=UTF-8\\r\\n\\r\\n\"`\n\n3. 相关资料\n======\n- http://wdicc.com/sendmail-use-perl/\n- http://www.cnblogs.com/quitboy/p/4605694.html\n- http://www.chinaemail.com.cn/blog/content/667/\n","slug":"Erlang发送邮件相关问题","published":1,"updated":"2015-10-22T10:23:35.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cig77xoal000gi9s60vrqsjyj"},{"title":"Erlang_Efficiency_guide_非标准笔记","date":"2015-10-24T06:27:28.000Z","_content":"Efficiency guide 译文\n===\n\ntimer模块\n====\n通过`erlang:send_after/3` 或`erlang:start_timer/3` 来启动一个定时器会比使用timer模块更加有效率。timer模块使用一个独立的进程来管理定时器，因此该进程很容易过载，如果很多进程频繁创建或取消定时器。\n\n`list_to_atom/1`\n====\nAtoms 是不参与垃圾回收的。一旦一个原子被创建，它将不会被回收，Erlang虚拟机会因为atoms数量太多（默认1048576）而导致崩溃。\n因此，转换输入的字符参数变成atom会导致系统变得不安全。如果只允许已经定义的原子可以允许被转换，可以使用 `list_to_existing_atom/1`去避免服务器崩溃。（这就使得我们需要提前创建所有允许被创建的atiom\n\n`length/1`\n====\n执行`length/1`所消耗的时间是与输入列表的长度成比例增长的。而 `erlang:tuple_size/1`、`byte_size/1`、和`bit_size/1`的执行时间是常量时间。因此避免对长度过长的list进行`leng/1`运算。一些对`length/1`的使用可以被替换成模式匹配，比如：\n    foo(L) when length(L) >=3 -> .....\n可以替换为\n    foo([_,_,_|_]=L)->....\n另外对不使用的变量命名为`_`也可以提升程序效率。\n\n`setelement/3`\n====\n`setelement/3`复制它修改的元祖，因此，在循环中调用`setelement/3`将会每次都创建新的副本。如果无法优化循环调用`setelement/3`的代码，那么对一个大tuple修改多个元素的最优办法就是将tuple转换为list修改list后再转换会tuple。\n\n`size/1`\n====\n`size/1`可以返回tuple或binary的大小。使用 BIFs `tuple_size/1`和 `byte_size/1`可以让编译器和运行时系统去优化性能。\n\n`split_binary/2`\n====\n通过模式匹配来切分binary会比调用`split_binary/2`来的快。另外，混合比特语法匹配和split_binary/2 会阻止一些对对比特语法匹配的优化。\n这样：\n    \"  Bin1:Num/binary,Bin2/binary  \" =Bin`\n而不要：\n    {Bin1,Bin2}=split_binary(Bin,Num)\n\n'--'操作符\n====\n列表的长度越长，`--`的效率就越低。\n不要：\n    HugeList1 -- HugeList2\n而是这样(对列表元素没有顺序要求的列表使用）：\n    HugeSet1 = ordsets:from_list(HugeList1),\n    HugeSet2 = ordsets:from_list(HugeList2),\n    ordsets:subtract(HugeSet1,HugeSet2)\n对于对列表元素有顺序要求的列表：\n`    Set=gb_sets:from_list(HugeList2),\n    [E|| E 《-HugeList1, not gb_sets:is_element(E，Set)]`\n\nbinaries 是如何被实例化的\n====\n在内部来说，binaries和bitstring是一样的东西。\n在虚拟机内部有四种类型的binary对象。有两种包含了binary数据，另外两种仅仅只是引用了binary的一部分。而binary容器是 引用binaries（引用计数binaries的缩写）和堆binaries（heap binaries）。\n- Refc binaries 包含两部分：\n  1.一个保存在进程堆的（process heap）对象，即ProcBin,所有的ProcBin都是进程链接的一部分，因此gc 会追踪它们，并且在ProcBin消失后减少引用次数。\n  2.保存在所有进程堆之外的binary对象，binary对象可以被任意个ProcBins（任意个进程中）引用，它包含了引用计数器用来计算当前引用的数量，当引用数量为0时就会被回收。\n- Heap binaries 是小binaries，最大为64字节。所以直接保存在程序的堆中。它将会在进程gc或当作消息发送时被复制，gc不需要任何的处理就可以回收。\n有两种类型的引用对象可以引用 一个refc binary 或 heap binary，它们就是 sub binaries 和 匹配文本。\nsub binaries 由 `split_binary/2` 创建或者匹配到一个binary时。sun binaries 只是引用了其他binaries的一部分（refc binaries 或heap binary），因此匹配binaries是非常廉价的，因为他不会发生任何的拷贝。\n上下文匹配和sub binary类似，不同的是对binary 匹配做了优化；举个例子，它包含了一个直接指向binary数据的指针。\n\n构造二进制\n====\n运行时系统特别对附加binary作了优化，举个例子：\n    Bin0= \"  0 \",  %%为变量Bin0绑定一个heap binary，\n    Bin1=\"  Bin0/binary,1,2,3  \"  %%创建一个refc binary 其内容是Bin0的副本，refc binary的ProcBin部分拥有数据的大小（数据存储到二进制中的大小），binary object 却会有额外的空间被开辟，binary object的大小可能是 Bin0的两倍或者是256（或者更大）。\n    Bin2 =\" Bin1/binary,4,5,6\"\n\n\n\n","source":"_posts/Erlang-Efficiency-guide-非标准笔记.md","raw":"title: Erlang_Efficiency_guide_非标准笔记\ndate: 2015-10-24 14:27:28\ntags: [Erlang]\n---\nEfficiency guide 译文\n===\n\ntimer模块\n====\n通过`erlang:send_after/3` 或`erlang:start_timer/3` 来启动一个定时器会比使用timer模块更加有效率。timer模块使用一个独立的进程来管理定时器，因此该进程很容易过载，如果很多进程频繁创建或取消定时器。\n\n`list_to_atom/1`\n====\nAtoms 是不参与垃圾回收的。一旦一个原子被创建，它将不会被回收，Erlang虚拟机会因为atoms数量太多（默认1048576）而导致崩溃。\n因此，转换输入的字符参数变成atom会导致系统变得不安全。如果只允许已经定义的原子可以允许被转换，可以使用 `list_to_existing_atom/1`去避免服务器崩溃。（这就使得我们需要提前创建所有允许被创建的atiom\n\n`length/1`\n====\n执行`length/1`所消耗的时间是与输入列表的长度成比例增长的。而 `erlang:tuple_size/1`、`byte_size/1`、和`bit_size/1`的执行时间是常量时间。因此避免对长度过长的list进行`leng/1`运算。一些对`length/1`的使用可以被替换成模式匹配，比如：\n    foo(L) when length(L) >=3 -> .....\n可以替换为\n    foo([_,_,_|_]=L)->....\n另外对不使用的变量命名为`_`也可以提升程序效率。\n\n`setelement/3`\n====\n`setelement/3`复制它修改的元祖，因此，在循环中调用`setelement/3`将会每次都创建新的副本。如果无法优化循环调用`setelement/3`的代码，那么对一个大tuple修改多个元素的最优办法就是将tuple转换为list修改list后再转换会tuple。\n\n`size/1`\n====\n`size/1`可以返回tuple或binary的大小。使用 BIFs `tuple_size/1`和 `byte_size/1`可以让编译器和运行时系统去优化性能。\n\n`split_binary/2`\n====\n通过模式匹配来切分binary会比调用`split_binary/2`来的快。另外，混合比特语法匹配和split_binary/2 会阻止一些对对比特语法匹配的优化。\n这样：\n    \"  Bin1:Num/binary,Bin2/binary  \" =Bin`\n而不要：\n    {Bin1,Bin2}=split_binary(Bin,Num)\n\n'--'操作符\n====\n列表的长度越长，`--`的效率就越低。\n不要：\n    HugeList1 -- HugeList2\n而是这样(对列表元素没有顺序要求的列表使用）：\n    HugeSet1 = ordsets:from_list(HugeList1),\n    HugeSet2 = ordsets:from_list(HugeList2),\n    ordsets:subtract(HugeSet1,HugeSet2)\n对于对列表元素有顺序要求的列表：\n`    Set=gb_sets:from_list(HugeList2),\n    [E|| E 《-HugeList1, not gb_sets:is_element(E，Set)]`\n\nbinaries 是如何被实例化的\n====\n在内部来说，binaries和bitstring是一样的东西。\n在虚拟机内部有四种类型的binary对象。有两种包含了binary数据，另外两种仅仅只是引用了binary的一部分。而binary容器是 引用binaries（引用计数binaries的缩写）和堆binaries（heap binaries）。\n- Refc binaries 包含两部分：\n  1.一个保存在进程堆的（process heap）对象，即ProcBin,所有的ProcBin都是进程链接的一部分，因此gc 会追踪它们，并且在ProcBin消失后减少引用次数。\n  2.保存在所有进程堆之外的binary对象，binary对象可以被任意个ProcBins（任意个进程中）引用，它包含了引用计数器用来计算当前引用的数量，当引用数量为0时就会被回收。\n- Heap binaries 是小binaries，最大为64字节。所以直接保存在程序的堆中。它将会在进程gc或当作消息发送时被复制，gc不需要任何的处理就可以回收。\n有两种类型的引用对象可以引用 一个refc binary 或 heap binary，它们就是 sub binaries 和 匹配文本。\nsub binaries 由 `split_binary/2` 创建或者匹配到一个binary时。sun binaries 只是引用了其他binaries的一部分（refc binaries 或heap binary），因此匹配binaries是非常廉价的，因为他不会发生任何的拷贝。\n上下文匹配和sub binary类似，不同的是对binary 匹配做了优化；举个例子，它包含了一个直接指向binary数据的指针。\n\n构造二进制\n====\n运行时系统特别对附加binary作了优化，举个例子：\n    Bin0= \"  0 \",  %%为变量Bin0绑定一个heap binary，\n    Bin1=\"  Bin0/binary,1,2,3  \"  %%创建一个refc binary 其内容是Bin0的副本，refc binary的ProcBin部分拥有数据的大小（数据存储到二进制中的大小），binary object 却会有额外的空间被开辟，binary object的大小可能是 Bin0的两倍或者是256（或者更大）。\n    Bin2 =\" Bin1/binary,4,5,6\"\n\n\n\n","slug":"Erlang-Efficiency-guide-非标准笔记","published":1,"updated":"2015-10-24T06:28:23.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cig77xoan000ii9s6demqp93s"},{"title":"Cowboy的路由机制","date":"2015-10-22T10:24:56.000Z","_content":"\n路由机制\n=====\n配置链接URL到Erlang模块（处理对应请求的模块）的映射就是路由。\n\n当 Cowboy接收到一个请求时，它会尝试在给定的分发规则中匹配 域名 到对应的资源路径。如果匹配成功，那么对应的Erlang 模块就会被执行。\n\nCowboy首先会匹配域名，接着尝试找到匹配的资源路径。\n\nCowboy会将路由规则编译后，再使用。\n\n\n结构\n=====\n通用的路由结构是这样定义的：\n`Routes= [Host1, Host2, ... HostN].`\n\n每一个域名的匹配规则 包含了 对连接路径的选项约束和路径部件的列表。\n\n`Host1= {HostMatch, PathsList}.`\n`Host2= {HostMatch, Constraints, PathsList}.`\n\n路径部件的定义如下：\n`PathsList= [Path1, Path2, ... PathN].`\n\n最后，每一路径包含了该路径自身的匹配规则以及对应的处理模块\n`Path1= {PathMatch, Handler, Opts}.`\n`Path2= {PathMatch, Constraints, Handler, Opts}.`\n\n匹配规则语法\n=====\n匹配语法规则用于标识 域名到路径间的处理handlers。\n域名的语法规则：\n`HostMatch1= \"cowboy.example.org\".`\n`HostMatch2= \"cowboy.example.org.\".`\n`HostMatch3= \".cowboy.example.org\".`\n\n路径的语法规则：\n`PathMatch= \"/hats/:name/prices\".`\n`HostMatch= \":subdomain.example.org\".`\n\n此外，还可以将域名的某一字段保存到Req对象中，再后续可以使用，这就是值绑定。\n`PathMatch= \"/hats/:name/prices\".`\n`HostMatch= \":subdomain.example.org\".`\n比如，http://test.example.org/hats/wild_cowboy_legendary/prices 将会\n把test绑定到subdomain，而wild_cowboy_legendary就会绑定到name，它们可以被cow_req:binding/{2,3}中检索，绑定的名字必须是一个atom\n'_'：表示匹配任何内容\n\n约束\n=====\n匹配域名和路径完成后，就会检测是否满足可选的约束，约束如下：\n```erlang\n{Name, int}\n{Name, function, fun ((Value) -> true | {true, NewValue} | false)}\n```\nint 约束将会检查 绑定的二进制串是一个int，或可被转化成一个int\nfunction约束，将会调用给定的约束函数并且返回结果，给定函数必须自己保证不会崩溃的。\n\n\n为了保存Cowboy可以更高效地查找正确的handler模块，Cowboy会编译定义好的路由分发规则。\n编译的方法是：cowboy_router:compile/1.\n```erlang\n\tDispatch= cowboy_router:compile([\n    %% {HostMatch, list({PathMatch, Handler, Opts})}\n    {'_', [{'_', my_handler, []}]}\n\t]),\n\t%% Name, NbAcceptors, TransOpts, ProtoOpts\n\tcowboy:start_http(my_http_listener, 100,\n   \t[{port, 8080}],\n   \t[{env, [{dispatch, Dispatch}]}]\n\t).\n```\n如果定义好的路由分发规则有错误，cowboy_router:compile/1 \n将会返回{error, badarg}\n\n在线更新路由规则\n=====\n通过 cowboy:set_env/3更新路由的分发规则，连接监听模块接受新的连接时就会使用新的路由分发规则。\n```erlang\n    cowboy:set_env(my_http_listener, dispatch,\n    cowboy_router:compile(Dispatch)).\n```\n\n\n\n\n","source":"_posts/Cowboy的路由机制.md","raw":"title: Cowboy的路由机制\ndate: 2015-10-22 18:24:56\ntags: [Cowboy]\n---\n\n路由机制\n=====\n配置链接URL到Erlang模块（处理对应请求的模块）的映射就是路由。\n\n当 Cowboy接收到一个请求时，它会尝试在给定的分发规则中匹配 域名 到对应的资源路径。如果匹配成功，那么对应的Erlang 模块就会被执行。\n\nCowboy首先会匹配域名，接着尝试找到匹配的资源路径。\n\nCowboy会将路由规则编译后，再使用。\n\n\n结构\n=====\n通用的路由结构是这样定义的：\n`Routes= [Host1, Host2, ... HostN].`\n\n每一个域名的匹配规则 包含了 对连接路径的选项约束和路径部件的列表。\n\n`Host1= {HostMatch, PathsList}.`\n`Host2= {HostMatch, Constraints, PathsList}.`\n\n路径部件的定义如下：\n`PathsList= [Path1, Path2, ... PathN].`\n\n最后，每一路径包含了该路径自身的匹配规则以及对应的处理模块\n`Path1= {PathMatch, Handler, Opts}.`\n`Path2= {PathMatch, Constraints, Handler, Opts}.`\n\n匹配规则语法\n=====\n匹配语法规则用于标识 域名到路径间的处理handlers。\n域名的语法规则：\n`HostMatch1= \"cowboy.example.org\".`\n`HostMatch2= \"cowboy.example.org.\".`\n`HostMatch3= \".cowboy.example.org\".`\n\n路径的语法规则：\n`PathMatch= \"/hats/:name/prices\".`\n`HostMatch= \":subdomain.example.org\".`\n\n此外，还可以将域名的某一字段保存到Req对象中，再后续可以使用，这就是值绑定。\n`PathMatch= \"/hats/:name/prices\".`\n`HostMatch= \":subdomain.example.org\".`\n比如，http://test.example.org/hats/wild_cowboy_legendary/prices 将会\n把test绑定到subdomain，而wild_cowboy_legendary就会绑定到name，它们可以被cow_req:binding/{2,3}中检索，绑定的名字必须是一个atom\n'_'：表示匹配任何内容\n\n约束\n=====\n匹配域名和路径完成后，就会检测是否满足可选的约束，约束如下：\n```erlang\n{Name, int}\n{Name, function, fun ((Value) -> true | {true, NewValue} | false)}\n```\nint 约束将会检查 绑定的二进制串是一个int，或可被转化成一个int\nfunction约束，将会调用给定的约束函数并且返回结果，给定函数必须自己保证不会崩溃的。\n\n\n为了保存Cowboy可以更高效地查找正确的handler模块，Cowboy会编译定义好的路由分发规则。\n编译的方法是：cowboy_router:compile/1.\n```erlang\n\tDispatch= cowboy_router:compile([\n    %% {HostMatch, list({PathMatch, Handler, Opts})}\n    {'_', [{'_', my_handler, []}]}\n\t]),\n\t%% Name, NbAcceptors, TransOpts, ProtoOpts\n\tcowboy:start_http(my_http_listener, 100,\n   \t[{port, 8080}],\n   \t[{env, [{dispatch, Dispatch}]}]\n\t).\n```\n如果定义好的路由分发规则有错误，cowboy_router:compile/1 \n将会返回{error, badarg}\n\n在线更新路由规则\n=====\n通过 cowboy:set_env/3更新路由的分发规则，连接监听模块接受新的连接时就会使用新的路由分发规则。\n```erlang\n    cowboy:set_env(my_http_listener, dispatch,\n    cowboy_router:compile(Dispatch)).\n```\n\n\n\n\n","slug":"Cowboy的路由机制","published":1,"updated":"2015-10-22T10:25:18.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cig77xoao000ki9s6fzhvgqjy"}],"PostAsset":[],"PostCategory":[],"PostTag":[{"post_id":"cig77xo9w0002i9s63hw0hsb4","tag_id":"cig77xoa00003i9s6z7o6jyf7","_id":"cig77xoa10004i9s6ye6qac69"},{"post_id":"cig77xoag0005i9s6s8dv9toh","tag_id":"cig77xoah0006i9s6h88mdauq","_id":"cig77xoah0008i9s6g6nydfdo"},{"post_id":"cig77xoag0005i9s6s8dv9toh","tag_id":"cig77xoah0007i9s6mks46z0d","_id":"cig77xoah0009i9s66vg84cdw"},{"post_id":"cig77xoai000ai9s6zpyjn2yf","tag_id":"cig77xoaj000bi9s6u873765d","_id":"cig77xoaj000ci9s6shy3kkxx"},{"post_id":"cig77xoak000di9s6ewlxly3i","tag_id":"cig77xoak000ei9s6j8r1qa8s","_id":"cig77xoal000fi9s63ao409fx"},{"post_id":"cig77xoal000gi9s60vrqsjyj","tag_id":"cig77xoak000ei9s6j8r1qa8s","_id":"cig77xoam000hi9s68pitkuo5"},{"post_id":"cig77xoan000ii9s6demqp93s","tag_id":"cig77xoak000ei9s6j8r1qa8s","_id":"cig77xoao000ji9s6xdp81crc"},{"post_id":"cig77xoao000ki9s6fzhvgqjy","tag_id":"cig77xoap000li9s6g9c3o6cj","_id":"cig77xoap000mi9s6gd59oje2"}],"Tag":[{"name":"Ejabberd","_id":"cig77xoa00003i9s6z7o6jyf7"},{"name":"Riak","_id":"cig77xoah0006i9s6h88mdauq"},{"name":"MapReduce","_id":"cig77xoah0007i9s6mks46z0d"},{"name":"mqtt","_id":"cig77xoaj000bi9s6u873765d"},{"name":"Erlang","_id":"cig77xoak000ei9s6j8r1qa8s"},{"name":"Cowboy","_id":"cig77xoap000li9s6g9c3o6cj"}]}}